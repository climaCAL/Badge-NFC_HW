<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive BOM for KiCAD</title>
  <style type="text/css">
:root {
  --pcb-edge-color: black;
  --pad-color: #878787;
  --pad-hole-color: #CCCCCC;
  --pad-color-highlight: #D04040;
  --pad-color-highlight-both: #D0D040;
  --pad-color-highlight-marked: #44a344;
  --pin1-outline-color: #ffb629;
  --pin1-outline-color-highlight: #ffb629;
  --pin1-outline-color-highlight-both: #fcbb39;
  --pin1-outline-color-highlight-marked: #fdbe41;
  --silkscreen-edge-color: #aa4;
  --silkscreen-polygon-color: #4aa;
  --silkscreen-text-color: #4aa;
  --fabrication-edge-color: #907651;
  --fabrication-polygon-color: #907651;
  --fabrication-text-color: #a27c24;
  --track-color: #def5f1;
  --track-color-highlight: #D04040;
  --zone-color: #def5f1;
  --zone-color-highlight: #d0404080;
}

html,
body {
  margin: 0px;
  height: 100%;
  font-family: Verdana, sans-serif;
}

.dark.topmostdiv {
  --pcb-edge-color: #eee;
  --pad-color: #808080;
  --pin1-outline-color: #ffa800;
  --pin1-outline-color-highlight: #ccff00;
  --track-color: #42524f;
  --zone-color: #42524f;
  background-color: #252c30;
  color: #eee;
}

button {
  background-color: #eee;
  border: 1px solid #888;
  color: black;
  height: 44px;
  width: 44px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  font-weight: bolder;
}

.dark button {
  /* This will be inverted */
  background-color: #c3b7b5;
}

button.depressed {
  background-color: #0a0;
  color: white;
}

.dark button.depressed {
  /* This will be inverted */
  background-color: #b3b;
}

button:focus {
  outline: 0;
}

button#tb-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.32 290.12h5.82M1.32 291.45h5.82' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 292.5v4.23M.26 292.63H8.2' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='1.35' y='295.73'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#lr-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.06 290.12H3.7m-2.64 1.33H3.7m-2.64 1.32H3.7m-2.64 1.3H3.7m-2.64 1.33H3.7' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 288.8v7.94m0-4.11h3.96' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='5.11' y='291.96'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#bom-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)' fill='none' stroke='%23000' stroke-width='.4'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' stroke-linejoin='round'/%3E%3Cpath d='M1.59 290.12h5.29M1.59 291.45h5.33M1.59 292.75h5.33M1.59 294.09h5.33M1.59 295.41h5.33'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-grouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m4 0h5m4 0h3M6.1 22h3m3.9 0h5m4 0h4m-16-8h4m4 0h4'/%3E%3Cpath stroke-linecap='null' d='M5 17.5h22M5 26.6h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-ungrouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m-4 8h3m-3 8h4'/%3E%3Cpath stroke-linecap='null' d='M5 13.5h22m-22 8h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-netlist-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg fill='none' stroke='%23000' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-width='2' d='M6 26l6-6v-8m13.8-6.3l-6 6v8'/%3E%3Ccircle cx='11.8' cy='9.5' r='2.8' stroke-width='2'/%3E%3Ccircle cx='19.8' cy='22.8' r='2.8' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E");
}

button#copy {
  background-image: url("data:image/svg+xml,%3Csvg height='48' viewBox='0 0 48 48' width='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h48v48h-48z' fill='none'/%3E%3Cpath d='M32 2h-24c-2.21 0-4 1.79-4 4v28h4v-28h24v-4zm6 8h-22c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm0 32h-22v-28h22v28z'/%3E%3C/svg%3E");
  background-position: 6px 6px;
  background-repeat: no-repeat;
  background-size: 26px 26px;
  border-radius: 6px;
  height: 40px;
  width: 40px;
  margin: 10px 5px;
}

button#copy:active {
  box-shadow: inset 0px 0px 5px #6c6c6c;
}

textarea.clipboard-temp {
  position: fixed;
  top: 0;
  left: 0;
  width: 2em;
  height: 2em;
  padding: 0;
  border: None;
  outline: None;
  box-shadow: None;
  background: transparent;
}

.left-most-button {
  border-right: 0;
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.middle-button {
  border-right: 0;
}

.right-most-button {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.button-container {
  font-size: 0;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.dark .button-container {
  filter: invert(1);
}

.button-container button {
  background-size: 32px 32px;
  background-position: 5px 5px;
  background-repeat: no-repeat;
}

@media print {
  .hideonprint {
    display: none;
  }
}

canvas {
  cursor: crosshair;
}

canvas:active {
  cursor: grabbing;
}

.fileinfo {
  width: 100%;
  max-width: 1000px;
  border: none;
  padding: 3px;
}

.fileinfo .title {
  font-size: 20pt;
  font-weight: bold;
}

.fileinfo td {
  overflow: hidden;
  white-space: nowrap;
  max-width: 1px;
  width: 50%;
  text-overflow: ellipsis;
}

.bom {
  border-collapse: collapse;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 10pt;
  table-layout: fixed;
  width: 100%;
  margin-top: 1px;
  position: relative;
}

.bom th,
.bom td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

.dark .bom th,
.dark .bom td {
  border: 1px solid #777;
}

.bom th {
  background-color: #CCCCCC;
  background-clip: padding-box;
}

.dark .bom th {
  background-color: #3b4749;
}

.bom tr.highlighted:nth-child(n) {
  background-color: #cfc;
}

.dark .bom tr.highlighted:nth-child(n) {
  background-color: #226022;
}

.bom tr:nth-child(even) {
  background-color: #f2f2f2;
}

.dark .bom tr:nth-child(even) {
  background-color: #313b40;
}

.bom tr.checked {
  color: #1cb53d;
}

.dark .bom tr.checked {
  color: #2cce54;
}

.bom tr {
  transition: background-color 0.2s;
}

.bom .numCol {
  width: 30px;
}

.bom .value {
  width: 15%;
}

.bom .quantity {
  width: 65px;
}

.bom th .sortmark {
  position: absolute;
  right: 1px;
  top: 1px;
  margin-top: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #221 transparent;
  transform-origin: 50% 85%;
  transition: opacity 0.2s, transform 0.4s;
}

.dark .bom th .sortmark {
  filter: invert(1);
}

.bom th .sortmark.none {
  opacity: 0;
}

.bom th .sortmark.desc {
  transform: rotate(180deg);
}

.bom th:hover .sortmark.none {
  opacity: 0.5;
}

.bom .bom-checkbox {
  width: 30px;
  position: relative;
  user-select: none;
  -moz-user-select: none;
}

.bom .bom-checkbox:before {
  content: "";
  position: absolute;
  border-width: 15px;
  border-style: solid;
  border-color: #51829f transparent transparent transparent;
  visibility: hidden;
  top: -15px;
}

.bom .bom-checkbox:after {
  content: "Double click to set/unset all";
  position: absolute;
  color: white;
  top: -35px;
  left: -26px;
  background: #51829f;
  padding: 5px 15px;
  border-radius: 8px;
  white-space: nowrap;
  visibility: hidden;
}

.bom .bom-checkbox:hover:before,
.bom .bom-checkbox:hover:after {
  visibility: visible;
  transition: visibility 0.2s linear 1s;
}

.split {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
  background-color: inherit;
}

.split.split-horizontal,
.gutter.gutter-horizontal {
  height: 100%;
  float: left;
}

.gutter {
  background-color: #ddd;
  background-repeat: no-repeat;
  background-position: 50%;
  transition: background-color 0.3s;
}

.dark .gutter {
  background-color: #777;
}

.gutter.gutter-horizontal {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
  cursor: ew-resize;
  width: 5px;
}

.gutter.gutter-vertical {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
  cursor: ns-resize;
  height: 5px;
}

.searchbox {
  float: left;
  height: 40px;
  margin: 10px 5px;
  padding: 12px 32px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 18px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 6px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4T8XSMUvDQBQH8P/LElFa/AIZHcTBQSz0I/gFstTBRR2KUC4ldDxw7h0Bl3RRUATxi4iiODgoiLNrbQYp5J6cpJJqomkX33Z37/14d/dIa33MzDuYI4johOI4XhyNRteO46zNYjDzAxE1yBZprVeZ+QbAUhXEGJMA2Ox2u4+fQIa0mPmsCgCgJYQ4t7lfgF0opQYAdv9ABkKI/UnOFCClXKjX61cA1osQY8x9kiRNKeV7IWA3oyhaSdP0FkAtjxhj3hzH2RBCPOf3pzqYHCilfAAX+URm9oMguPzeWSGQvUcMYC8rOBJCHBRdqxTo9/vbRHRqi8bj8XKv1xvODbiuW2u32/bvf0SlDv4XYOY7z/Mavu+nM1+BmQ+NMc0wDF/LprP0DbTWW0T00ul0nn4b7Q87+X4Qmfiq2wAAAABJRU5ErkJggg==');
  background-position: 10px 10px;
  background-repeat: no-repeat;
}

.dark .searchbox {
  background-color: #111;
  color: #eee;
}

.searchbox::placeholder {
  color: #ccc;
}

.dark .searchbox::placeholder {
  color: #666;
}

.filter {
  width: calc(60% - 64px);
}

.reflookup {
  width: calc(40% - 10px);
}

input[type=text]:focus {
  background-color: white;
  border: 1px solid #333;
}

.dark input[type=text]:focus {
  background-color: #333;
  border: 1px solid #ccc;
}

mark.highlight {
  background-color: #5050ff;
  color: #fff;
  padding: 2px;
  border-radius: 6px;
}

.dark mark.highlight {
  background-color: #76a6da;
  color: #111;
}

.menubtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 20 20'%3E%3Cpath fill='none' d='M0 0h20v20H0V0z'/%3E%3Cpath d='M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z'/%3E%3C/svg%3E%0A");
  background-position: center;
  background-repeat: no-repeat;
}

.statsbtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg width='36' height='36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 6h28v24H4V6zm0 8h28v8H4m9-16v24h10V5.8' fill='none' stroke='%23000' stroke-width='2'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.iobtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M3 33v-7l6.8-7h16.5l6.7 7v7H3zM3.2 26H33M21 9l5-5.9 5 6h-2.5V15h-5V9H21zm-4.9 0l-5 6-5-6h2.5V3h5v6h2.5z'/%3E%3Cpath fill='none' stroke='%23000' d='M6.1 29.5H10'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.visbtn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' stroke='%23333' d='M2.5 4.5h5v15h-5zM9.5 4.5h5v15h-5zM16.5 4.5h5v15h-5z'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
  padding: 15px;
}

#vismenu-content {
  left: 0px;
  font-family: Verdana, sans-serif;
}

.dark .statsbtn,
.dark .savebtn,
.dark .menubtn,
.dark .iobtn,
.dark .visbtn {
  filter: invert(1);
}

.flexbox {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.savebtn {
  background-color: #d6d6d6;
  width: auto;
  height: 30px;
  flex-grow: 1;
  margin: 5px;
  border-radius: 4px;
}

.savebtn:active {
  background-color: #0a0;
  color: white;
}

.dark .savebtn:active {
  /* This will be inverted */
  background-color: #b3b;
}

.stats {
  border-collapse: collapse;
  font-size: 12pt;
  table-layout: fixed;
  width: 100%;
  min-width: 450px;
}

.dark .stats td {
  border: 1px solid #bbb;
}

.stats td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

#checkbox-stats div {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#checkbox-stats .bar {
  background-color: rgba(28, 251, 0, 0.6);
}

.menu {
  position: relative;
  display: inline-block;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.menu-content {
  font-size: 12pt !important;
  text-align: left !important;
  font-weight: normal !important;
  display: none;
  position: absolute;
  background-color: white;
  right: 0;
  min-width: 300px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 100;
  padding: 8px;
}

.dark .menu-content {
  background-color: #111;
}

.menu:hover .menu-content {
  display: block;
}

.menu:hover .menubtn,
.menu:hover .iobtn,
.menu:hover .statsbtn {
  background-color: #eee;
}

.menu-label {
  display: inline-block;
  padding: 8px;
  border: 1px solid #ccc;
  border-top: 0;
  width: calc(100% - 18px);
}

.menu-label-top {
  border-top: 1px solid #ccc;
}

.menu-textbox {
  float: left;
  height: 24px;
  margin: 10px 5px;
  padding: 5px 5px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 14px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 4px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  width: calc(100% - 10px);
}

.menu-textbox.invalid,
.dark .menu-textbox.invalid {
  color: red;
}

.dark .menu-textbox {
  background-color: #222;
  color: #eee;
}

.radio-container {
  margin: 4px;
}

.topmostdiv {
  display: flex;
  flex-direction: column;
  width: 100%;
  background-color: white;
  transition: background-color 0.3s;
  min-height: 100%;
}

#top {
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-end;
  align-items: center;
}

#topdivider {
  border-bottom: 2px solid black;
  display: flex;
  justify-content: center;
  align-items: center;
}

.dark #topdivider {
  border-bottom: 2px solid #ccc;
}

#topdivider>div {
  position: relative;
}

#toptoggle {
  cursor: pointer;
  user-select: none;
  position: absolute;
  padding: 0.1rem 0.3rem;
  top: -0.4rem;
  left: -1rem;
  font-size: 1.4rem;
  line-height: 60%;
  border: 1px solid black;
  border-radius: 1rem;
  background-color: #fff;
  z-index: 100;
}

.flipped {
  transform: rotate(0.5turn);
}

.dark #toptoggle {
  border: 1px solid #fff;
  background-color: #222;
}

#fileinfodiv {
  flex: 20rem 1 0;
  overflow: auto;
}

#bomcontrols {
  display: flex;
  flex-direction: row-reverse;
}

#bomcontrols>* {
  flex-shrink: 0;
}

#dbg {
  display: block;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #aaa;
}

::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  margin: 3px 0;
  padding: 0;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
  border-radius: 3px;
}

.slider:hover {
  opacity: 1;
}

.slider:focus {
  outline: none;
}

.slider::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
  border: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin-top: -4px;
}

.dark .slider::-webkit-slider-thumb {
  background: #3d3;
}

.slider::-moz-range-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
}

.slider::-moz-range-track {
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
}

.dark .slider::-moz-range-thumb {
  background: #3d3;
}

.slider::-ms-track {
  width: 100%;
  height: 8px;
  border-width: 3px 0;
  background: transparent;
  border-color: transparent;
  color: transparent;
  transition: opacity .2s;
}

.slider::-ms-fill-lower {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-fill-upper {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin: 0;
}

.shameless-plug {
  font-size: 0.8em;
  text-align: center;
  display: block;
}

a {
  color: #0278a4;
}

.dark a {
  color: #00b9fd;
}

#frontcanvas,
#backcanvas {
  touch-action: none;
}

.placeholder {
  border: 1px dashed #9f9fda !important;
  background-color: #edf2f7 !important;
}

.dragging {
  z-index: 999;
}

.dark .dragging>table>tbody>tr {
  background-color: #252c30;
}

.dark .placeholder {
  filter: invert(1);
}

.column-spacer {
  top: 0;
  left: 0;
  width: calc(100% - 4px);
  position: absolute;
  cursor: pointer;
  user-select: none;
  height: 100%;
}

.column-width-handle {
  top: 0;
  right: 0;
  width: 4px;
  position: absolute;
  cursor: col-resize;
  user-select: none;
  height: 100%;
}

.column-width-handle:hover {
  background-color: #4f99bd;
}

.help-link {
  border: 1px solid #0278a4;
  padding-inline: 0.3rem;
  border-radius: 3px;
  cursor: pointer;
}

.dark .help-link {
  border: 1px solid #00b9fd;
}

.bom-color {
  width: 20%;
}

.color-column input {
  width: 1.6rem;
  height: 1rem;
  border: 1px solid black;
  cursor: pointer;
  padding: 0;
}

/* removes default styling from input color element */
::-webkit-color-swatch {
  border: none;
}

::-webkit-color-swatch-wrapper {
  padding: 0;
}

::-moz-color-swatch,
::-moz-focus-inner {
  border: none;
}

::-moz-focus-inner {
  padding: 0;
}

    /* --- INTEGRATION PRODUCTION (User CSS) --- */
    #production-controls { display: none; }
    #custom-header-buttons { position: absolute; top: 12px; right: 340px; height: auto; display: flex; align-items: center; gap: 10px; z-index: 100001; pointer-events: none; }
    
    .ui-btn { 
        padding: 6px 12px; border: none; border-radius: 4px; color: white; font-weight: bold; cursor: pointer; 
        font-size: 13px; min-width: 130px; height: 34px; box-shadow: 0 3px 5px rgba(0,0,0,0.3); 
        transition: all 0.2s ease; text-transform: uppercase; display: inline-flex; align-items: center; 
        justify-content: center; pointer-events: auto; background-color: #34495e; border: 1px solid #2c3e50;
    }
    .ui-btn:active { transform: translateY(2px); box-shadow: 0 1px 2px rgba(0,0,0,0.3); }
    
    .icon-btn { width: 34px; height: 34px; min-width: 34px; border-radius: 4px; border: 1px solid #555; background: #34495e; color: #ddd; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; pointer-events: auto; transition: background 0.2s; }
    .icon-btn:hover { background: #4e6a85; }
    .icon-btn.connected { border-color: #27ae60; color: #27ae60; border-width: 2px; }

    #btn-mode-toggle.mode-active, #btn-mode-in-header.mode-active { background-color: #27ae60 !important; border: 1px solid #2ecc71 !important; }
    #btn-mode-toggle.rework-alert, #btn-mode-in-header.rework-alert { 
        background-color: #e74c3c !important; border-color: #c0392b !important; 
        box-shadow: 0 0 10px rgba(231, 76, 60, 0.8) !important; animation: pulse-ui 1s infinite;
    }
    
    @keyframes pulse-ui { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

    #btn-report { background-color: #2980b9; border: 1px solid #3498db; }
    #btn-report:hover { background-color: #3498db; }
    
    .rev-text-span { font-size: 20px; font-weight: bold; color: inherit; white-space: nowrap; display: flex !important; flex-direction: column !important; justify-content: center !important; line-height: 1.2 !important; text-align: left !important; }
    .custom-overlay { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(4px); justify-content: center; align-items: center; font-family: 'Segoe UI', Verdana, sans-serif; }
    .custom-overlay.active { display: flex; }
    .custom-card { background: #2b3e50; color: #ecf0f1; padding: 25px; border-radius: 12px; text-align: left; box-shadow: 0 15px 40px rgba(0,0,0,0.8); width: 85%; max-width: 400px; position: relative; border: 1px solid #4a6fa5; animation: popIn 0.3s ease-out; }
    @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    .close-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; color: #aaa; font-size: 24px; cursor: pointer; padding: 0; line-height: 1; }
    #details-overlay .close-btn, #rework-overlay .close-btn, #login-overlay .close-btn { display: none; }
    h2 { margin-top: 0; color: #ffb629; border-bottom: 1px solid #555; padding-bottom: 10px; font-size: 20px; margin-bottom: 20px; }
    .info-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 1.1em; border-bottom: 1px dashed #3e5871; padding-bottom: 5px; }
    .info-label { font-weight: bold; color: #8fa1b3; }
    .info-value { font-family: monospace; color: #fff; font-size: 1.2em; }
    .action-btn { width: 100%; padding: 15px; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 20px; transition: background 0.2s; }
    .btn-next { background: #27ae60; color: white; }
    .btn-next:hover { background: #2ecc71; }
    .btn-submit { background: #e74c3c; color: white; }
    .btn-submit:hover { background: #c0392b; }
    .btn-blue { background: #3498db; color: white; }
    .btn-blue:hover { background: #2980b9; }
    textarea.rework-input, input.login-input { width: 100%; background: #1a252f; border: 1px solid #95a5a6; border-radius: 4px; color: white; padding: 10px; font-family: sans-serif; font-size: 16px; box-sizing: border-box; margin-bottom: 15px; }
    textarea.rework-input { height: 100px; border-color: #e74c3c; resize: none; }
    input.login-input:focus, textarea.rework-input:focus { outline: 2px solid #ffb629; }
    .login-label { display: block; margin-bottom: 5px; color: #bdc3c7; font-size: 0.9em; }

    @media (max-height: 650px) {
        #custom-header-buttons { right: 300px; top: 8px; gap: 5px; }
        .ui-btn { min-width: 110px; font-size: 11px; height: 30px; padding: 4px 8px; }
        .icon-btn { width: 30px; height: 30px; min-width: 30px; font-size: 14px; }
        .rev-text-span { font-size: 16px; }
        .custom-card { padding: 15px; max-height: 85vh; overflow-y: auto; }
        h2 { font-size: 16px; margin-bottom: 10px; padding-bottom: 5px; }
        .info-row { margin-bottom: 6px; font-size: 0.95em; padding-bottom: 3px; }
        .info-value { font-size: 1.1em; }
        .action-btn { padding: 10px; margin-top: 10px; font-size: 14px; }
        textarea.rework-input { height: 60px; margin-bottom: 10px; }
        input.login-input { margin-bottom: 8px; padding: 8px; }
        p { margin-bottom: 8px !important; font-size: 0.9em; }
    }


  </style>
  <script type="text/javascript" >
///////////////////////////////////////////////
/*
  Split.js - v1.3.5
  MIT License
  https://github.com/nathancahill/Split.js
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Split=t()}(this,function(){"use strict";var e=window,t=e.document,n="addEventListener",i="removeEventListener",r="getBoundingClientRect",s=function(){return!1},o=e.attachEvent&&!e[n],a=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(u,c){function z(e,t,n){var i=A(y,t,n);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function h(e,t){var n=B(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function f(e){var t=E[this.a],n=E[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,z(t.element,t.size,this.aGutterSize),z(n.element,n.size,this.bGutterSize)}function m(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=E[this.a].minSize+M+this.aGutterSize?t=E[this.a].minSize+this.aGutterSize:t>=this.size-(E[this.b].minSize+M+this.bGutterSize)&&(t=this.size-(E[this.b].minSize+this.bGutterSize)),f.call(this,t),c.onDrag&&c.onDrag())}function g(){var e=E[this.a].element,t=E[this.b].element;this.size=e[r]()[y]+t[r]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[r]()[G]}function d(){var t=this,n=E[t.a].element,r=E[t.b].element;t.dragging&&c.onDragEnd&&c.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function S(t){var i=this,r=E[i.a].element,o=E[i.b].element;!i.dragging&&c.onDragStart&&c.onDragStart(),t.preventDefault(),i.dragging=!0,i.move=m.bind(i),i.stop=d.bind(i),e[n]("mouseup",i.stop),e[n]("touchend",i.stop),e[n]("touchcancel",i.stop),i.parent[n]("mousemove",i.move),i.parent[n]("touchmove",i.move),r[n]("selectstart",s),r[n]("dragstart",s),o[n]("selectstart",s),o[n]("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",i.gutter.style.cursor=j,i.parent.style.cursor=j,g.call(i)}function v(e){e.forEach(function(t,n){if(n>0){var i=F[n-1],r=E[i.a],s=E[i.b];r.size=e[n-1],s.size=t,z(r.element,r.size,i.aGutterSize),z(s.element,s.size,i.bGutterSize)}})}function p(){F.forEach(function(e){e.parent.removeChild(e.gutter),E[e.a].element.style[y]="",E[e.b].element.style[y]=""})}void 0===c&&(c={});var y,b,G,E,w=l(u[0]).parentNode,D=e.getComputedStyle(w).flexDirection,U=c.sizes||u.map(function(){return 100/u.length}),k=void 0!==c.minSize?c.minSize:100,x=Array.isArray(k)?k:u.map(function(){return k}),L=void 0!==c.gutterSize?c.gutterSize:10,M=void 0!==c.snapOffset?c.snapOffset:30,O=c.direction||"horizontal",j=c.cursor||("horizontal"===O?"ew-resize":"ns-resize"),C=c.gutter||function(e,n){var i=t.createElement("div");return i.className="gutter gutter-"+n,i},A=c.elementStyle||function(e,t,n){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=o?t+"%":a+"("+t+"% - "+n+"px)",i},B=c.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",G="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",G="top","paddingTop");var F=[];return E=u.map(function(e,t){var i,s={element:l(e),size:U[t],minSize:x[t]};if(t>0&&(i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===u.length-1,direction:O,parent:w},i.aGutterSize=L,i.bGutterSize=L,i.isFirst&&(i.aGutterSize=L/2),i.isLast&&(i.bGutterSize=L/2),"row-reverse"===D||"column-reverse"===D)){var a=i.a;i.a=i.b,i.b=a}if(!o&&t>0){var c=C(t,O);h(c,L),c[n]("mousedown",S.bind(i)),c[n]("touchstart",S.bind(i)),w.insertBefore(c,s.element),i.gutter=c}0===t||t===u.length-1?z(s.element,s.size,L/2):z(s.element,s.size,L);var f=s.element[r]()[y];return f<s.minSize&&(s.minSize=f),t>0&&F.push(i),s}),o?{setSizes:v,destroy:p}:{setSizes:v,getSizes:function(){return E.map(function(e){return e.size})},collapse:function(e){if(e===F.length){var t=F[e-1];g.call(t),o||f.call(t,t.size-t.bGutterSize)}else{var n=F[e];g.call(n),o||f.call(n,n.aGutterSize)}},destroy:p}}});

///////////////////////////////////////////////

///////////////////////////////////////////////
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4
var LZString=function(){var o=String.fromCharCode,i={};var n={decompressFromBase64:function(o){return null==o?"":""==o?null:n._decompress(o.length,32,function(n){return function(o,n){if(!i[o]){i[o]={};for(var t=0;t<o.length;t++)i[o][o.charAt(t)]=t}return i[o][n]}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o.charAt(n))})},_decompress:function(i,n,t){var r,e,a,s,p,u,l,f=[],c=4,d=4,h=3,v="",g=[],m={val:t(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,p=Math.pow(2,2),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 2:return""}for(f[3]=l,e=l,g.push(l);;){if(m.index>i)return"";for(a=0,p=Math.pow(2,h),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 2:return g.join("")}if(0==c&&(c=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==d)return null;v=e+e.charAt(0)}g.push(v),f[d++]=e+v.charAt(0),e=v,0==--c&&(c=Math.pow(2,h),h++)}}};return n}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
///////////////////////////////////////////////

///////////////////////////////////////////////
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PointerEventsPolyfill=b()}(this,function(){"use strict";function a(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);
for(var d,e=2;e<m.length;e++)d=m[e],c[d]=b[d]||n[e];c.buttons=b.buttons||0;
var f=0;return f=b.pressure&&c.buttons?b.pressure:c.buttons?.5:0,c.x=c.clientX,c.y=c.clientY,c.pointerId=b.pointerId||0,c.width=b.width||0,c.height=b.height||0,c.pressure=f,c.tiltX=b.tiltX||0,c.tiltY=b.tiltY||0,c.twist=b.twist||0,c.tangentialPressure=b.tangentialPressure||0,c.pointerType=b.pointerType||"",c.hwTimestamp=b.hwTimestamp||0,c.isPrimary=b.isPrimary||!1,c}function b(){this.array=[],this.size=0}function c(a,b,c,d){this.addCallback=a.bind(d),this.removeCallback=b.bind(d),this.changedCallback=c.bind(d),A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action="'+a+'"]'}function f(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; }"}function g(){if(F){D.forEach(function(a){String(a)===a?(E+=e(a)+f(a)+"\n",G&&(E+=d(a)+f(a)+"\n")):(E+=a.selectors.map(e)+f(a.rule)+"\n",G&&(E+=a.selectors.map(d)+f(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=E,document.head.appendChild(a)}}function h(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var b=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:b,enumerable:!0}),u.registerSource("ms",_)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",N),void 0!==window.ontouchstart&&u.registerSource("touch",V);u.register(document)}}function i(a){if(!u.pointermap.has(a)){var b=new Error("InvalidPointerId");throw b.name="InvalidPointerId",b}}function j(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b){var c=new Error("InvalidStateError");throw c.name="InvalidStateError",c}}function k(a){var b=u.pointermap.get(a);return 0!==b.buttons}function l(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:X},hasPointerCapture:{value:Y}})}
var m=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],o=window.Map&&window.Map.prototype.forEach,p=o?Map:b;b.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.array.length=0,this.size=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var q=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],s={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},t="undefined"!=typeof SVGElementInstance,u={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b,d=c.events;d&&(d.forEach(function(a){c[a]&&(this.eventMap[a]=c[a].bind(c))},this),this.eventSources[a]=c,this.eventSourceList.push(c))},register:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(c){return!1}},down:function(a){a.bubbles=!0,this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0,this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0,this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1,this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1,this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0,this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0,this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0,this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a),this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a),this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type,c=this.eventMap&&this.eventMap[b];c&&c(a),a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(b,c){this.captureInfo[c.pointerId]&&(c.relatedTarget=null);var d=new a(b,c);return c.preventDefault&&(d.preventDefault=c.preventDefault),d._target=d._target||c.target,d},fireEvent:function(a,b){var c=this.makeEvent(a,b);return this.dispatchEvent(c)},cloneEvent:function(a){for(var b,c=Object.create(null),d=0;d<q.length;d++)b=q[d],c[b]=a[b]||r[d],!t||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){var b=this.captureInfo[a.pointerId];return b?a._target!==b&&a.type in s?void 0:b:a._target},propagate:function(a,b,c){for(var d=a.target,e=[];d!==document&&!d.contains(a.relatedTarget);) if(e.push(d),d=d.parentNode,!d)return;c&&e.reverse(),e.forEach(function(c){a.target=c,b.call(this,a)},this)},setCapture:function(b,c,d){this.captureInfo[b]&&this.releaseCapture(b,d),this.captureInfo[b]=c,this.implicitRelease=this.releaseCapture.bind(this,b,d),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var e=new a("gotpointercapture");e.pointerId=b,e._target=c,d||this.asyncDispatchEvent(e)},releaseCapture:function(b,c){var d=this.captureInfo[b];if(d){this.captureInfo[b]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var e=new a("lostpointercapture");e.pointerId=b,e._target=d,c||this.asyncDispatchEvent(e)}},dispatchEvent:/*scope.external.dispatchEvent || */function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};u.boundHandler=u.eventHandler.bind(u);var v={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&Boolean(a.elementFromPoint)},targetingShadow:function(a){var b=this.shadow(a);if(this.canTarget(b))return b},olderShadow:function(a){var b=a.olderShadowRoot;if(!b){var c=a.querySelector("shadow");c&&(b=c.olderShadowRoot)}return b},allShadows:function(a){for(var b=[],c=this.shadow(a);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(a,b,c){if(a){var d,e,f=a.elementFromPoint(b,c);for(e=this.targetingShadow(f);e;){if(d=e.elementFromPoint(b,c)){var g=this.targetingShadow(d);return this.searchRoot(g,b,c)||d} e=this.olderShadow(e)} return f}},owner:function(a){
for(var b=a;b.parentNode;)b=b.parentNode;
return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(a){var b=a.clientX,c=a.clientY,d=this.owner(a.target);
return d.elementFromPoint(b,c)||(d=document),this.searchRoot(d,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),y=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,B="[touch-action]",C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(a){
//
this.observer&&v.canTarget(a)&&this.observer.observe(a,C)},enableOnSubtree:function(a){this.watchSubtree(a),a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll(B):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},
installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){
var b=x(a,this.findElements,this);
return b.push(z(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){if("childList"===a.type){var b=this.flattenMutationTree(a.addedNodes);b.forEach(this.addElement,this);var c=this.flattenMutationTree(a.removedNodes);c.forEach(this.removeElement,this)}else"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],E="",F=window.PointerEvent||window.MSPointerEvent,G=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,H=u.pointermap,I=25,J=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(L){}
var M,N={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],
isEventSimulatedFromTouch:function(a){for(var b,c=this.lastTouches,d=a.clientX,e=a.clientY,f=0,g=c.length;f<g&&(b=c[f]);f++){
var h=Math.abs(d-b.x),i=Math.abs(e-b.y);if(h<=I&&i<=I)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=H.get(this.POINTER_ID);
0!==b.which&&c?a.buttons=c.buttons:a.buttons=0,b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);K||(c.buttons=J[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons),H.set(this.POINTER_ID,a),b&&0!==b.buttons?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);if(!K){var d=J[c.button];
c.buttons=b?b.buttons&~d:0,a.buttons=c.buttons}H.set(this.POINTER_ID,a),
c.buttons&=~J[c.button],0===c.buttons?u.up(c):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,u.leaveOut(b)}},cancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.deactivateMouse()},deactivateMouse:function(){H["delete"](this.POINTER_ID)}},O=u.captureInfo,P=v.findTarget.bind(v),Q=v.allShadows.bind(v),R=u.pointermap,S=2500,T=200,U="touch-action",V={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){M.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute(U),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),
Q(a).forEach(function(a){a._scrollType=c,u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0,u.unlisten(a,this.events),
Q(a).forEach(function(a){a._scrollType=void 0,u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute(U),d=this.touchActionToScrollType(c),e=this.touchActionToScrollType(b);
d&&e?(a._scrollType=d,Q(a).forEach(function(a){a._scrollType=d},this)):e?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=a,c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){
(0===R.size||1===R.size&&R.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(a,T)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return"touchstart"!==a&&"touchmove"!==a||(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=O[d]||P(c),c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount,c.button=0,c.buttons=this.typeToButtons(b.type),c.width=2*(a.radiusX||a.webkitRadiusX||0),c.height=2*(a.radiusY||a.webkitRadiusY||0),c.pressure=a.force||a.webkitForce||.5,c.isPrimary=this.isPrimaryTouch(a),c.pointerType=this.POINTER_TYPE,
c.altKey=b.altKey,c.ctrlKey=b.ctrlKey,c.metaKey=b.metaKey,c.shiftKey=b.shiftKey;
var e=this;return c.preventDefault=function(){e.scrolling=!1,e.firstXY=null,b.preventDefault()},c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;for(var d,e=0;e<c.length;e++)d=c[e],b.call(this,this.touchToPointer(d))},
shouldScroll:function(a){if(this.firstXY){var b,c=a.currentTarget._scrollType;if("none"===c)
b=!1;else if("XY"===c)
b=!0;else{var d=a.changedTouches[0],e=c,f="Y"===c?"X":"Y",g=Math.abs(d["client"+e]-this.firstXY[e]),h=Math.abs(d["client"+f]-this.firstXY[f]);
b=g>=h}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d]);d++)if(c.identifier===b)return!0},
vacuumTouches:function(a){var b=a.touches;
if(R.size>=b.length){var c=[];R.forEach(function(a,d){
if(1!==d&&!this.findTouch(b,d-2)){var e=a.out;c.push(e)}},this),c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a),this.setPrimaryTouch(a.changedTouches[0]),this.dedupSynthMouse(a),this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){R.set(a.pointerId,{target:a.target,out:a,outTarget:a.target}),u.enterOver(a),u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=a,c=R.get(b.pointerId);
if(c){var d=c.out,e=c.outTarget;u.move(b),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,
d.target=e,b.target?(u.leaveOut(d),u.enterOver(b)):(
b.target=e,b.relatedTarget=null,this.cancelOut(b))),c.out=b,c.outTarget=b.target}},touchend:function(a){this.dedupSynthMouse(a),this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.leaveOut(a)),this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a),u.leaveOut(a),this.cleanUpPointer(a)},cleanUpPointer:function(a){R["delete"](a.pointerId),this.removePrimaryPointer(a)},
dedupSynthMouse:function(a){var b=N.lastTouches,c=a.changedTouches[0];
if(this.isPrimaryTouch(c)){
var d={x:c.clientX,y:c.clientY};b.push(d);var e=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}.bind(null,b,d);setTimeout(e,S)}}};M=new c(V.elementAdded,V.elementRemoved,V.elementChanged,V);var W,X,Y,Z=u.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,_={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return $&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){Z["delete"](a)},MSPointerDown:function(a){Z.set(a.pointerId,a);var b=this.prepareEvent(a);u.down(b)},MSPointerMove:function(a){var b=this.prepareEvent(a);u.move(b)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b),this.cleanup(a.pointerId)},MSPointerOut:function(a){var b=this.prepareEvent(a);u.leaveOut(b)},MSPointerOver:function(a){var b=this.prepareEvent(a);u.enterOver(b)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){var b=u.makeEvent("lostpointercapture",a);u.dispatchEvent(b)},MSGotPointerCapture:function(a){var b=u.makeEvent("gotpointercapture",a);u.dispatchEvent(b)}},aa=window.navigator;aa.msPointerEnabled?(W=function(a){i(a),j(this),k(a)&&(u.setCapture(a,this,!0),this.msSetPointerCapture(a))},X=function(a){i(a),u.releaseCapture(a,!0),this.msReleasePointerCapture(a)}):(W=function(a){i(a),j(this),k(a)&&u.setCapture(a,this)},X=function(a){i(a),u.releaseCapture(a)}),Y=function(a){return!!u.captureInfo[a]},g(),h(),l();var ba={dispatcher:u,Installer:c,PointerEvent:a,PointerMap:p,targetFinding:v};return ba});

///////////////////////////////////////////////

///////////////////////////////////////////////
var config = {"dark_mode": false, "show_pads": true, "show_fabrication": false, "show_silkscreen": true, "highlight_pin1": "none", "redraw_on_drag": true, "board_rotation": 0, "checkboxes": "Sourced,Placed", "bom_view": "left-right", "layer_view": "FB", "offset_back_rotation": false, "kicad_text_formatting": true, "mark_when_checked": "", "fields": ["Value", "Footprint"]}
///////////////////////////////////////////////

///////////////////////////////////////////////
var pcbdata = JSON.parse(LZString.decompressFromBase64("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"))
///////////////////////////////////////////////

///////////////////////////////////////////////
/* Utility functions */

var storagePrefix = 'KiCad_HTML_BOM__' + pcbdata.metadata.title + '__' +
  pcbdata.metadata.revision + '__#';
var storage;

function initStorage(key) {
  try {
    window.localStorage.getItem("blank");
    storage = window.localStorage;
  } catch (e) {
    // localStorage not available
  }
  if (!storage) {
    try {
      window.sessionStorage.getItem("blank");
      storage = window.sessionStorage;
    } catch (e) {
      // sessionStorage also not available
    }
  }
}

function readStorage(key) {
  if (storage) {
    return storage.getItem(storagePrefix + key);
  } else {
    return null;
  }
}

function writeStorage(key, value) {
  if (storage) {
    storage.setItem(storagePrefix + key, value);
  }
}

function fancyDblClickHandler(el, onsingle, ondouble) {
  return function () {
    if (el.getAttribute("data-dblclick") == null) {
      el.setAttribute("data-dblclick", 1);
      setTimeout(function () {
        if (el.getAttribute("data-dblclick") == 1) {
          onsingle();
        }
        el.removeAttribute("data-dblclick");
      }, 200);
    } else {
      el.removeAttribute("data-dblclick");
      ondouble();
    }
  }
}

function smoothScrollToRow(rowid) {
  document.getElementById(rowid).scrollIntoView({
    behavior: "smooth",
    block: "center",
    inline: "nearest"
  });
}

function focusInputField(input) {
  input.scrollIntoView(false);
  input.focus();
  input.select();
}

function saveBomTable(output) {
  var text = '';
  for (var node of bomhead.childNodes[0].childNodes) {
    if (node.firstChild) {
      var name = node.firstChild.nodeValue ?? "";
      text += (output == 'csv' ? `"${name}"` : name);
    }
    if (node != bomhead.childNodes[0].lastChild) {
      text += (output == 'csv' ? ',' : '\t');
    }
  }
  text += '\n';
  for (var row of bombody.childNodes) {
    for (var cell of row.childNodes) {
      let val = '';
      for (var node of cell.childNodes) {
        if (node.nodeName == "INPUT") {
          if (node.checked) {
            val += '';
          }
        } else if ((node.nodeName == "MARK") || (node.nodeName == "A")) {
          val += node.firstChild.nodeValue;
        } else {
          val += node.nodeValue;
        }
      }
      if (output == 'csv') {
        val = val.replace(/\"/g, '\"\"'); // pair of double-quote characters
        if (isNumeric(val)) {
          val = +val;                     // use number
        } else {
          val = `"${val}"`;               // enclosed within double-quote
        }
      }
      text += val;
      if (cell != row.lastChild) {
        text += (output == 'csv' ? ',' : '\t');
      }
    }
    text += '\n';
  }

  if (output != 'clipboard') {
    // To file: csv or txt
    var blob = new Blob([text], {
      type: `text/${output}`
    });
    saveFile(`${pcbdata.metadata.title}.${output}`, blob);
  } else {
    // To clipboard
    var textArea = document.createElement("textarea");
    textArea.classList.add('clipboard-temp');
    textArea.value = text;

    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
      if (document.execCommand('copy')) {
        console.log('Bom copied to clipboard.');
      }
    } catch (err) {
      console.log('Can not copy to clipboard.');
    }

    document.body.removeChild(textArea);
  }
}

function isNumeric(str) {
  /* https://stackoverflow.com/a/175787 */
  return (typeof str != "string" ? false : !isNaN(str) && !isNaN(parseFloat(str)));
}

function removeGutterNode(node) {
  for (var i = 0; i < node.childNodes.length; i++) {
    if (node.childNodes[i].classList &&
      node.childNodes[i].classList.contains("gutter")) {
      node.removeChild(node.childNodes[i]);
      break;
    }
  }
}

function cleanGutters() {
  removeGutterNode(document.getElementById("bot"));
  removeGutterNode(document.getElementById("canvasdiv"));
}

var units = {
  prefixes: {
    giga: ["G", "g", "giga", "Giga", "GIGA"],
    mega: ["M", "mega", "Mega", "MEGA"],
    kilo: ["K", "k", "kilo", "Kilo", "KILO"],
    milli: ["m", "milli", "Milli", "MILLI"],
    micro: ["U", "u", "micro", "Micro", "MICRO", "", ""], // different utf8 
    nano: ["N", "n", "nano", "Nano", "NANO"],
    pico: ["P", "p", "pico", "Pico", "PICO"],
  },
  unitsShort: ["R", "r", "", "F", "f", "H", "h"],
  unitsLong: [
    "OHM", "Ohm", "ohm", "ohms",
    "FARAD", "Farad", "farad",
    "HENRY", "Henry", "henry"
  ],
  getMultiplier: function (s) {
    if (this.prefixes.giga.includes(s)) return 1e9;
    if (this.prefixes.mega.includes(s)) return 1e6;
    if (this.prefixes.kilo.includes(s)) return 1e3;
    if (this.prefixes.milli.includes(s)) return 1e-3;
    if (this.prefixes.micro.includes(s)) return 1e-6;
    if (this.prefixes.nano.includes(s)) return 1e-9;
    if (this.prefixes.pico.includes(s)) return 1e-12;
    return 1;
  },
  valueRegex: null,
  valueAltRegex: null,
}

function initUtils() {
  var allPrefixes = units.prefixes.giga
    .concat(units.prefixes.mega)
    .concat(units.prefixes.kilo)
    .concat(units.prefixes.milli)
    .concat(units.prefixes.micro)
    .concat(units.prefixes.nano)
    .concat(units.prefixes.pico);
  var allUnits = units.unitsShort.concat(units.unitsLong);
  units.valueRegex = new RegExp("^([0-9\.]+)" +
    "\\s*(" + allPrefixes.join("|") + ")?" +
    "(" + allUnits.join("|") + ")?" +
    "(\\b.*)?$", "");
  units.valueAltRegex = new RegExp("^([0-9]*)" +
    "(" + units.unitsShort.join("|") + ")?" +
    "([GgMmKkUuNnPp])?" +
    "([0-9]*)" +
    "(\\b.*)?$", "");
  if (config.fields.includes("Value")) {
    var index = config.fields.indexOf("Value");
    pcbdata.bom["parsedValues"] = {};
    var allList = getBomListByLayer('FB').flat();
    for (var id in pcbdata.bom.fields) {
      var ref_key = allList.find(item => item[1] == Number(id)) || [];
      pcbdata.bom.parsedValues[id] = parseValue(pcbdata.bom.fields[id][index], ref_key[0] || '');
    }
  }
}

function parseValue(val, ref) {
  var inferUnit = (unit, ref) => {
    if (unit) {
      unit = unit.toLowerCase();
      if (unit == '' || unit == "ohm" || unit == "ohms") {
        unit = 'r';
      }
      return unit[0];
    }

    var resarr = /^([a-z]+)\d+$/i.exec(ref);
    switch (Array.isArray(resarr) && resarr[1].toLowerCase()) {
      case "c": return 'f';
      case "l": return 'h';
      case "r":
      case "rv": return 'r';
    }
    return null;
  };
  val = val.replace(/,/g, "");
  var match = units.valueRegex.exec(val);
  if (Array.isArray(match)) {
    var unit = inferUnit(match[3], ref);
    var val_i = parseFloat(match[1]);
    if (!unit) return null;
    if (match[2]) {
      val_i = val_i * units.getMultiplier(match[2]);
    }
    return {
      val: val_i,
      unit: unit,
      extra: match[4],
    }
  }

  match = units.valueAltRegex.exec(val);
  if (Array.isArray(match) && (match[1] || match[4])) {
    var unit = inferUnit(match[2], ref);
    var val_i = parseFloat(match[1] + "." + match[4]);
    if (!unit) return null;
    if (match[3]) {
      val_i = val_i * units.getMultiplier(match[3]);
    }
    return {
      val: val_i,
      unit: unit,
      extra: match[5],
    }
  }
  return null;
}

function valueCompare(a, b, stra, strb) {
  if (a === null && b === null) {
    // Failed to parse both values, compare them as strings.
    if (stra != strb) return stra > strb ? 1 : -1;
    else return 0;
  } else if (a === null) {
    return 1;
  } else if (b === null) {
    return -1;
  } else {
    if (a.unit != b.unit) return a.unit > b.unit ? 1 : -1;
    else if (a.val != b.val) return a.val > b.val ? 1 : -1;
    else if (a.extra != b.extra) return a.extra > b.extra ? 1 : -1;
    else return 0;
  }
}

function validateSaveImgDimension(element) {
  var valid = false;
  var intValue = 0;
  if (/^[1-9]\d*$/.test(element.value)) {
    intValue = parseInt(element.value);
    if (intValue <= 16000) {
      valid = true;
    }
  }
  if (valid) {
    element.classList.remove("invalid");
  } else {
    element.classList.add("invalid");
  }
  return intValue;
}

function saveImage(layer) {
  var width = validateSaveImgDimension(document.getElementById("render-save-width"));
  var height = validateSaveImgDimension(document.getElementById("render-save-height"));
  var bgcolor = null;
  if (!document.getElementById("render-save-transparent").checked) {
    var style = getComputedStyle(topmostdiv);
    bgcolor = style.getPropertyValue("background-color");
  }
  if (!width || !height) return;

  // Prepare image
  var canvas = document.createElement("canvas");
  var layerdict = {
    transform: {
      x: 0,
      y: 0,
      s: 1,
      panx: 0,
      pany: 0,
      zoom: 1,
    },
    bg: canvas,
    fab: canvas,
    silk: canvas,
    highlight: canvas,
    layer: layer,
  }
  // Do the rendering
  recalcLayerScale(layerdict, width, height);
  prepareLayer(layerdict);
  clearCanvas(canvas, bgcolor);
  drawBackground(layerdict, false);
  drawHighlightsOnLayer(layerdict, false);

  // Save image
  var imgdata = canvas.toDataURL("image/png");

  var filename = pcbdata.metadata.title;
  if (pcbdata.metadata.revision) {
    filename += `.${pcbdata.metadata.revision}`;
  }
  filename += `.${layer}.png`;
  saveFile(filename, dataURLtoBlob(imgdata));
}

function saveSettings() {
  var data = {
    type: "InteractiveHtmlBom settings",
    version: 1,
    pcbmetadata: pcbdata.metadata,
    settings: settings,
  }
  var blob = new Blob([JSON.stringify(data, null, 4)], {
    type: "application/json"
  });
  saveFile(`${pcbdata.metadata.title}.settings.json`, blob);
}

function loadSettings() {
  var input = document.createElement("input");
  input.type = "file";
  input.accept = ".settings.json";
  input.onchange = function (e) {
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = readerEvent => {
      var content = readerEvent.target.result;
      var newSettings;
      try {
        newSettings = JSON.parse(content);
      } catch (e) {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      if (newSettings.type != "InteractiveHtmlBom settings") {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      var metadataMatches = newSettings.hasOwnProperty("pcbmetadata");
      if (metadataMatches) {
        for (var k in pcbdata.metadata) {
          if (!newSettings.pcbmetadata.hasOwnProperty(k) || newSettings.pcbmetadata[k] != pcbdata.metadata[k]) {
            metadataMatches = false;
          }
        }
      }
      if (!metadataMatches) {
        var currentMetadata = JSON.stringify(pcbdata.metadata, null, 4);
        var fileMetadata = JSON.stringify(newSettings.pcbmetadata, null, 4);
        if (!confirm(
          `Settins file metadata does not match current metadata.\n\n` +
          `Page metadata:\n${currentMetadata}\n\n` +
          `Settings file metadata:\n${fileMetadata}\n\n` +
          `Press OK if you would like to import settings anyway.`)) {
          return;
        }
      }
      overwriteSettings(newSettings.settings);
    }
    reader.readAsText(file, 'UTF-8');
  }
  input.click();
}

function resetSettings() {
  if (!confirm(
    `This will reset all checkbox states and other settings.\n\n` +
    `Press OK if you want to continue.`)) {
    return;
  }
  if (storage) {
    var keys = [];
    for (var i = 0; i < storage.length; i++) {
      var key = storage.key(i);
      if (key.startsWith(storagePrefix)) keys.push(key);
    }
    for (var key of keys) storage.removeItem(key);
  }
  location.reload();
}

function overwriteSettings(newSettings) {
  initDone = false;
  Object.assign(settings, newSettings);
  writeStorage("bomlayout", settings.bomlayout);
  writeStorage("bommode", settings.bommode);
  writeStorage("canvaslayout", settings.canvaslayout);
  writeStorage("bomCheckboxes", settings.checkboxes.join(","));
  document.getElementById("bomCheckboxes").value = settings.checkboxes.join(",");
  for (var checkbox of settings.checkboxes) {
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
  }
  writeStorage("markWhenChecked", settings.markWhenChecked);
  padsVisible(settings.renderPads);
  document.getElementById("padsCheckbox").checked = settings.renderPads;
  fabricationVisible(settings.renderFabrication);
  document.getElementById("fabricationCheckbox").checked = settings.renderFabrication;
  silkscreenVisible(settings.renderSilkscreen);
  document.getElementById("silkscreenCheckbox").checked = settings.renderSilkscreen;
  referencesVisible(settings.renderReferences);
  document.getElementById("referencesCheckbox").checked = settings.renderReferences;
  valuesVisible(settings.renderValues);
  document.getElementById("valuesCheckbox").checked = settings.renderValues;
  tracksVisible(settings.renderTracks);
  document.getElementById("tracksCheckbox").checked = settings.renderTracks;
  zonesVisible(settings.renderZones);
  document.getElementById("zonesCheckbox").checked = settings.renderZones;
  dnpOutline(settings.renderDnpOutline);
  document.getElementById("dnpOutlineCheckbox").checked = settings.renderDnpOutline;
  setRedrawOnDrag(settings.redrawOnDrag);
  document.getElementById("dragCheckbox").checked = settings.redrawOnDrag;
  setHighlightRowOnClick(settings.highlightRowOnClick);
  document.getElementById("highlightRowOnClickCheckbox").checked = settings.highlightRowOnClick;
  setDarkMode(settings.darkMode);
  document.getElementById("darkmodeCheckbox").checked = settings.darkMode;
  setHighlightPin1(settings.highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = settings.highlightpin1;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  setOffsetBackRotation(settings.offsetBackRotation);
  document.getElementById("offsetBackRotationCheckbox").checked = settings.offsetBackRotation;
  initDone = true;
  prepCheckboxes();
  changeBomLayout(settings.bomlayout);
}

function saveFile(filename, blob) {
  var link = document.createElement("a");
  var objurl = URL.createObjectURL(blob);
  link.download = filename;
  link.href = objurl;
  link.click();
}

function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','),
    mime = arr[0].match(/:(.*?);/)[1],
    bstr = atob(arr[1]),
    n = bstr.length,
    u8arr = new Uint8Array(n);
  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }
  return new Blob([u8arr], {
    type: mime
  });
}

var settings = {
  canvaslayout: "FB",
  bomlayout: "left-right",
  bommode: "grouped",
  checkboxes: [],
  checkboxStoredRefs: {},
  darkMode: false,
  highlightpin1: "none",
  redrawOnDrag: true,
  boardRotation: 0,
  offsetBackRotation: false,
  renderPads: true,
  renderReferences: true,
  renderValues: true,
  renderSilkscreen: true,
  renderFabrication: true,
  renderDnpOutline: false,
  renderTracks: true,
  renderZones: true,
  columnOrder: [],
  hiddenColumns: [],
  netColors: {},
}

function initDefaults() {
  settings.bomlayout = readStorage("bomlayout");
  if (settings.bomlayout === null) {
    settings.bomlayout = config.bom_view;
  }
  if (!['bom-only', 'left-right', 'top-bottom'].includes(settings.bomlayout)) {
    settings.bomlayout = config.bom_view;
  }
  settings.bommode = readStorage("bommode");
  if (settings.bommode === null) {
    settings.bommode = "grouped";
  }
  if (settings.bommode == "netlist" && !pcbdata.nets) {
    settings.bommode = "grouped";
  }
  if (!["grouped", "ungrouped", "netlist"].includes(settings.bommode)) {
    settings.bommode = "grouped";
  }
  settings.canvaslayout = readStorage("canvaslayout");
  if (settings.canvaslayout === null) {
    settings.canvaslayout = config.layer_view;
  }
  var bomCheckboxes = readStorage("bomCheckboxes");
  if (bomCheckboxes === null) {
    bomCheckboxes = config.checkboxes;
  }
  settings.checkboxes = bomCheckboxes.split(",").filter((e) => e);
  document.getElementById("bomCheckboxes").value = bomCheckboxes;

  var highlightpin1 = readStorage("highlightpin1") || config.highlight_pin1;
  if (highlightpin1 === "false") highlightpin1 = "none";
  if (highlightpin1 === "true") highlightpin1 = "all";
  setHighlightPin1(highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = highlightpin1;

  settings.markWhenChecked = readStorage("markWhenChecked");
  if (settings.markWhenChecked == null) {
    settings.markWhenChecked = config.mark_when_checked;
  }
  populateMarkWhenCheckedOptions();

  function initBooleanSetting(storageString, def, elementId, func) {
    var b = readStorage(storageString);
    if (b === null) {
      b = def;
    } else {
      b = (b == "true");
    }
    document.getElementById(elementId).checked = b;
    func(b);
  }

  initBooleanSetting("padsVisible", config.show_pads, "padsCheckbox", padsVisible);
  initBooleanSetting("fabricationVisible", config.show_fabrication, "fabricationCheckbox", fabricationVisible);
  initBooleanSetting("silkscreenVisible", config.show_silkscreen, "silkscreenCheckbox", silkscreenVisible);
  initBooleanSetting("referencesVisible", true, "referencesCheckbox", referencesVisible);
  initBooleanSetting("valuesVisible", true, "valuesCheckbox", valuesVisible);
  if ("tracks" in pcbdata) {
    initBooleanSetting("tracksVisible", true, "tracksCheckbox", tracksVisible);
    initBooleanSetting("zonesVisible", true, "zonesCheckbox", zonesVisible);
  } else {
    document.getElementById("tracksAndZonesCheckboxes").style.display = "none";
    tracksVisible(false);
    zonesVisible(false);
  }
  initBooleanSetting("dnpOutline", false, "dnpOutlineCheckbox", dnpOutline);
  initBooleanSetting("redrawOnDrag", config.redraw_on_drag, "dragCheckbox", setRedrawOnDrag);
  initBooleanSetting("highlightRowOnClick", false, "highlightRowOnClickCheckbox", setHighlightRowOnClick);
  initBooleanSetting("darkmode", config.dark_mode, "darkmodeCheckbox", setDarkMode);

  var fields = ["checkboxes", "References"].concat(config.fields).concat(["Quantity"]);
  var hcols = JSON.parse(readStorage("hiddenColumns"));
  if (hcols === null) {
    hcols = [];
  }
  settings.hiddenColumns = hcols.filter(e => fields.includes(e));

  var cord = JSON.parse(readStorage("columnOrder"));
  if (cord === null) {
    cord = fields;
  } else {
    cord = cord.filter(e => fields.includes(e));
    if (cord.length != fields.length)
      cord = fields;
  }
  settings.columnOrder = cord;

  settings.boardRotation = readStorage("boardRotation");
  if (settings.boardRotation === null) {
    settings.boardRotation = config.board_rotation * 5;
  } else {
    settings.boardRotation = parseInt(settings.boardRotation);
  }
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  initBooleanSetting("offsetBackRotation", config.offset_back_rotation, "offsetBackRotationCheckbox", setOffsetBackRotation);

  settings.netColors = JSON.parse(readStorage("netColors")) || {};
}

// Helper classes for user js callbacks.

const IBOM_EVENT_TYPES = {
  ALL: "all",
  HIGHLIGHT_EVENT: "highlightEvent",
  CHECKBOX_CHANGE_EVENT: "checkboxChangeEvent",
  BOM_BODY_CHANGE_EVENT: "bomBodyChangeEvent",
}

const EventHandler = {
  callbacks: {},
  init: function () {
    for (eventType of Object.values(IBOM_EVENT_TYPES))
      this.callbacks[eventType] = [];
  },
  registerCallback: function (eventType, callback) {
    this.callbacks[eventType].push(callback);
  },
  emitEvent: function (eventType, eventArgs) {
    event = {
      eventType: eventType,
      args: eventArgs,
    }
    var callback;
    for (callback of this.callbacks[eventType])
      callback(event);
    for (callback of this.callbacks[IBOM_EVENT_TYPES.ALL])
      callback(event);
  }
}
EventHandler.init();

///////////////////////////////////////////////

///////////////////////////////////////////////
/* PCB rendering code */

var emptyContext2d = document.createElement("canvas").getContext("2d");

function deg2rad(deg) {
  return deg * Math.PI / 180;
}

function calcFontPoint(linepoint, text, offsetx, offsety, tilt) {
  var point = [
    linepoint[0] * text.width + offsetx,
    linepoint[1] * text.height + offsety
  ];
  // This approximates pcbnew behavior with how text tilts depending on horizontal justification
  point[0] -= (linepoint[1] + 0.5 * (1 + text.justify[0])) * text.height * tilt;
  return point;
}

function drawText(ctx, text, color) {
  if ("ref" in text && !settings.renderReferences) return;
  if ("val" in text && !settings.renderValues) return;
  ctx.save();
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  if ("svgpath" in text) {
    if ("thickness" in text) {
      ctx.lineWidth = text.thickness;
      ctx.stroke(new Path2D(text.svgpath));
    } else if ("fillrule" in text) {
      ctx.fill(new Path2D(text.svgpath), text.fillrule);
    }
    ctx.restore();
    return;
  }
  ctx.lineWidth = text.thickness;
  if ("polygons" in text) {
    ctx.fill(getPolygonsPath(text));
    ctx.restore();
    return;
  }
  ctx.translate(...text.pos);
  ctx.translate(text.thickness * 0.5, 0);
  var angle = -text.angle;
  if (text.attr.includes("mirrored")) {
    ctx.scale(-1, 1);
    angle = -angle;
  }
  var tilt = 0;
  if (text.attr.includes("italic")) {
    tilt = 0.125;
  }
  var interline = text.height * 1.5 + text.thickness;
  var txt = text.text.split("\n");
  // KiCad ignores last empty line.
  if (txt[txt.length - 1] == '') txt.pop();
  ctx.rotate(deg2rad(angle));
  var offsety = (1 - text.justify[1]) / 2 * text.height; // One line offset
  offsety -= (txt.length - 1) * (text.justify[1] + 1) / 2 * interline; // Multiline offset
  for (var i in txt) {
    var lineWidth = text.thickness + interline / 2 * tilt;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        lineWidth += fourSpaces - lineWidth % fourSpaces;
      } else {
        if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
        }
        lineWidth += pcbdata.font_data[txt[i][j]].w * text.width;
      }
    }
    var offsetx = -lineWidth * (text.justify[0] + 1) / 2;
    var inOverbar = false;
    for (var j = 0; j < txt[i].length; j++) {
      if (config.kicad_text_formatting) {
        if (txt[i][j] == '\t') {
          var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
          offsetx += fourSpaces - offsetx % fourSpaces;
          continue;
        } else if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
          if (txt[i][j] != '~') {
            inOverbar = !inOverbar;
          }
        }
      }
      var glyph = pcbdata.font_data[txt[i][j]];
      if (inOverbar) {
        var overbarStart = [offsetx, -text.height * 1.4 + offsety];
        var overbarEnd = [offsetx + text.width * glyph.w, overbarStart[1]];

        if (!lastHadOverbar) {
          overbarStart[0] += text.height * 1.4 * tilt;
          lastHadOverbar = true;
        }
        ctx.beginPath();
        ctx.moveTo(...overbarStart);
        ctx.lineTo(...overbarEnd);
        ctx.stroke();
      } else {
        lastHadOverbar = false;
      }
      for (var line of glyph.l) {
        ctx.beginPath();
        ctx.moveTo(...calcFontPoint(line[0], text, offsetx, offsety, tilt));
        for (var k = 1; k < line.length; k++) {
          ctx.lineTo(...calcFontPoint(line[k], text, offsetx, offsety, tilt));
        }
        ctx.stroke();
      }
      offsetx += glyph.w * text.width;
    }
    offsety += interline;
  }
  ctx.restore();
}

function drawedge(ctx, scalefactor, edge, color) {
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineWidth = Math.max(1 / scalefactor, edge.width);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  if ("svgpath" in edge) {
    ctx.stroke(new Path2D(edge.svgpath));
  } else {
    ctx.beginPath();
    if (edge.type == "segment") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(...edge.end);
    }
    if (edge.type == "rect") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(edge.start[0], edge.end[1]);
      ctx.lineTo(...edge.end);
      ctx.lineTo(edge.end[0], edge.start[1]);
      ctx.lineTo(...edge.start);
    }
    if (edge.type == "arc") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        deg2rad(edge.startangle),
        deg2rad(edge.endangle));
    }
    if (edge.type == "circle") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        0, 2 * Math.PI);
      ctx.closePath();
    }
    if (edge.type == "curve") {
      ctx.moveTo(...edge.start);
      ctx.bezierCurveTo(...edge.cpa, ...edge.cpb, ...edge.end);
    }
    if("filled" in edge && edge.filled)
      ctx.fill();
    else
      ctx.stroke();
  }
}

function getChamferedRectPath(size, radius, chamfpos, chamfratio) {
  // chamfpos is a bitmask, left = 1, right = 2, bottom left = 4, bottom right = 8
  var path = new Path2D();
  var width = size[0];
  var height = size[1];
  var x = width * -0.5;
  var y = height * -0.5;
  var chamfOffset = Math.min(width, height) * chamfratio;
  path.moveTo(x, 0);
  if (chamfpos & 4) {
    path.lineTo(x, y + height - chamfOffset);
    path.lineTo(x + chamfOffset, y + height);
    path.lineTo(0, y + height);
  } else {
    path.arcTo(x, y + height, x + width, y + height, radius);
  }
  if (chamfpos & 8) {
    path.lineTo(x + width - chamfOffset, y + height);
    path.lineTo(x + width, y + height - chamfOffset);
    path.lineTo(x + width, 0);
  } else {
    path.arcTo(x + width, y + height, x + width, y, radius);
  }
  if (chamfpos & 2) {
    path.lineTo(x + width, y + chamfOffset);
    path.lineTo(x + width - chamfOffset, y);
    path.lineTo(0, y);
  } else {
    path.arcTo(x + width, y, x, y, radius);
  }
  if (chamfpos & 1) {
    path.lineTo(x + chamfOffset, y);
    path.lineTo(x, y + chamfOffset);
    path.lineTo(x, 0);
  } else {
    path.arcTo(x, y, x, y + height, radius);
  }
  path.closePath();
  return path;
}

function getOblongPath(size) {
  return getChamferedRectPath(size, Math.min(size[0], size[1]) / 2, 0, 0);
}

function getPolygonsPath(shape) {
  if (shape.path2d) {
    return shape.path2d;
  }
  if ("svgpath" in shape) {
    shape.path2d = new Path2D(shape.svgpath);
  } else {
    var path = new Path2D();
    for (var polygon of shape.polygons) {
      path.moveTo(...polygon[0]);
      for (var i = 1; i < polygon.length; i++) {
        path.lineTo(...polygon[i]);
      }
      path.closePath();
    }
    shape.path2d = path;
  }
  return shape.path2d;
}

function drawPolygonShape(ctx, scalefactor, shape, color) {
  ctx.save();
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  if("filled" in shape && !shape.filled) {
    ctx.strokeStyle = color;
    ctx.lineWidth = Math.max(1 / scalefactor, shape.width);
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.stroke(getPolygonsPath(shape));
  } else {
    ctx.fillStyle = color;
    ctx.fill(getPolygonsPath(shape));
  }
  ctx.restore();
}

function drawDrawing(ctx, scalefactor, drawing, color) {
  if (["segment", "arc", "circle", "curve", "rect"].includes(drawing.type)) {
    drawedge(ctx, scalefactor, drawing, color);
  } else if (drawing.type == "polygon") {
    drawPolygonShape(ctx, scalefactor, drawing, color);
  } else {
    drawText(ctx, drawing, color);
  }
}

function getCirclePath(radius) {
  var path = new Path2D();
  path.arc(0, 0, radius, 0, 2 * Math.PI);
  path.closePath();
  return path;
}

function getCachedPadPath(pad) {
  if (!pad.path2d) {
    // if path2d is not set, build one and cache it on pad object
    if (pad.shape == "rect") {
      pad.path2d = new Path2D();
      pad.path2d.rect(...pad.size.map(c => -c * 0.5), ...pad.size);
    } else if (pad.shape == "oval") {
      pad.path2d = getOblongPath(pad.size);
    } else if (pad.shape == "circle") {
      pad.path2d = getCirclePath(pad.size[0] / 2);
    } else if (pad.shape == "roundrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, 0, 0);
    } else if (pad.shape == "chamfrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, pad.chamfpos, pad.chamfratio)
    } else if (pad.shape == "custom") {
      pad.path2d = getPolygonsPath(pad);
    }
  }
  return pad.path2d;
}

function drawPad(ctx, pad, color, outline) {
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  if (pad.offset) {
    ctx.translate(...pad.offset);
  }
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  var path = getCachedPadPath(pad);
  if (outline) {
    ctx.stroke(path);
  } else {
    ctx.fill(path);
  }
  ctx.restore();
}

function drawPadHole(ctx, pad, padHoleColor) {
  if (pad.type != "th") return;
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  ctx.fillStyle = padHoleColor;
  if (pad.drillshape == "oblong") {
    ctx.fill(getOblongPath(pad.drillsize));
  } else if (pad.drillshape == "rect") {
    ctx.fill(getChamferedRectPath(pad.drillsize, 0, 0, 0));
  } else {
    ctx.fill(getCirclePath(pad.drillsize[0] / 2));
  }
  ctx.restore();
}

function drawFootprint(ctx, layer, scalefactor, footprint, colors, highlight, outline) {
  if (highlight) {
    // draw bounding box
    if (footprint.layer == layer) {
      ctx.save();
      ctx.globalAlpha = 0.2;
      ctx.translate(...footprint.bbox.pos);
      ctx.rotate(deg2rad(-footprint.bbox.angle));
      ctx.translate(...footprint.bbox.relpos);
      ctx.fillStyle = colors.pad;
      ctx.fillRect(0, 0, ...footprint.bbox.size);
      ctx.globalAlpha = 1;
      ctx.strokeStyle = colors.pad;
      ctx.lineWidth = 3 / scalefactor;
      ctx.strokeRect(0, 0, ...footprint.bbox.size);
      ctx.restore();
    }
  }
  // draw drawings
  for (var drawing of footprint.drawings) {
    if (drawing.layer == layer) {
      drawDrawing(ctx, scalefactor, drawing.drawing, colors.pad);
    }
  }
  ctx.lineWidth = 3 / scalefactor;
  // draw pads
  if (settings.renderPads) {
    for (var pad of footprint.pads) {
      if (pad.layers.includes(layer)) {
        drawPad(ctx, pad, colors.pad, outline);
        if (pad.pin1 &&
          (settings.highlightpin1 == "all" ||
            settings.highlightpin1 == "selected" && highlight)) {
          drawPad(ctx, pad, colors.outline, true);
        }
      }
    }
    for (var pad of footprint.pads) {
      drawPadHole(ctx, pad, colors.padHole);
    }
  }
}

function drawEdgeCuts(canvas, scalefactor) {
  var ctx = canvas.getContext("2d");
  var edgecolor = getComputedStyle(topmostdiv).getPropertyValue('--pcb-edge-color');
  for (var edge of pcbdata.edges) {
    drawDrawing(ctx, scalefactor, edge, edgecolor);
  }
}

function drawFootprints(canvas, layer, scalefactor, highlight) {
  var ctx = canvas.getContext("2d");
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);

  var colors = {
    pad: style.getPropertyValue('--pad-color'),
    padHole: style.getPropertyValue('--pad-hole-color'),
    outline: style.getPropertyValue('--pin1-outline-color'),
  }

  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var mod = pcbdata.footprints[i];
    var outline = settings.renderDnpOutline && pcbdata.bom.skipped.includes(i);
    var h = highlightedFootprints.includes(i);
    var d = markedFootprints.has(i);
    if (highlight) {
      if(h && d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-both');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-both');
      } else if (h) {
        colors.pad = style.getPropertyValue('--pad-color-highlight');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight');
      } else if (d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-marked');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-marked');
      }
    }
    if( h || d || !highlight) {
      drawFootprint(ctx, layer, scalefactor, mod, colors, highlight, outline);
    }
  }
}

function drawBgLayer(layername, canvas, layer, scalefactor, edgeColor, polygonColor, textColor) {
  var ctx = canvas.getContext("2d");
  for (var d of pcbdata.drawings[layername][layer]) {
    if (["segment", "arc", "circle", "curve", "rect"].includes(d.type)) {
      drawedge(ctx, scalefactor, d, edgeColor);
    } else if (d.type == "polygon") {
      drawPolygonShape(ctx, scalefactor, d, polygonColor);
    } else {
      drawText(ctx, d, textColor);
    }
  }
}

function drawTracks(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineCap = "round";

  var hasHole = (track) => (
    'drillsize' in track &&
    track.start[0] == track.end[0] &&
    track.start[1] == track.end[1]);

  // First draw tracks and tented vias
  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (!hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      if ('radius' in track) {
        ctx.arc(
          ...track.center,
          track.radius,
          deg2rad(track.startangle),
          deg2rad(track.endangle));
      } else {
        ctx.moveTo(...track.start);
        ctx.lineTo(...track.end);
      }
      ctx.stroke();
    }
  }
  // Second pass to draw untented vias
  var style = getComputedStyle(topmostdiv);
  var holeColor = style.getPropertyValue('--pad-hole-color')

  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      ctx.moveTo(...track.start);
      ctx.lineTo(...track.end);
      ctx.stroke();
      ctx.strokeStyle = holeColor;
      ctx.lineWidth = track.drillsize;
      ctx.lineTo(...track.end);
      ctx.stroke();
    }
  }
}

function drawZones(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineJoin = "round";
  for (var zone of pcbdata.zones[layer]) {
    if (highlight && highlightedNet != zone.net) continue;
    ctx.strokeStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    ctx.fillStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    if (!zone.path2d) {
      zone.path2d = getPolygonsPath(zone);
    }
    ctx.fill(zone.path2d, zone.fillrule || "nonzero");
    if (zone.width > 0) {
      ctx.lineWidth = zone.width;
      ctx.stroke(zone.path2d);
    }
  }
}

function clearCanvas(canvas, color = null) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  if (color) {
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  } else {
    if (!window.matchMedia("print").matches)
      ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  ctx.restore();
}

function drawNets(canvas, layer, highlight) {
  var style = getComputedStyle(topmostdiv);
  if (settings.renderZones) {
    var zoneColor = style.getPropertyValue(highlight ? '--zone-color-highlight' : '--zone-color');
    drawZones(canvas, layer, zoneColor, highlight);
  }
  if (settings.renderTracks) {
    var trackColor = style.getPropertyValue(highlight ? '--track-color-highlight' : '--track-color');
    drawTracks(canvas, layer, trackColor, highlight);
  }
  if (highlight && settings.renderPads) {
    var padColor = style.getPropertyValue('--pad-color-highlight');
    var padHoleColor = style.getPropertyValue('--pad-hole-color');
    var ctx = canvas.getContext("2d");
    for (var footprint of pcbdata.footprints) {
      // draw pads
      var padDrawn = false;
      for (var pad of footprint.pads) {
        if (highlightedNet != pad.net) continue;
        if (pad.layers.includes(layer)) {
          drawPad(ctx, pad, padColor, false);
          padDrawn = true;
        }
      }
      if (padDrawn) {
        // redraw all pad holes because some pads may overlap
        for (var pad of footprint.pads) {
          drawPadHole(ctx, pad, padHoleColor);
        }
      }
    }
  }
}

function drawHighlightsOnLayer(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.highlight);
  }
  if (markedFootprints.size > 0 || highlightedFootprints.length > 0) {
    drawFootprints(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true);
  }
  if (highlightedNet !== null) {
    drawNets(canvasdict.highlight, canvasdict.layer, true);
  }
}

function drawHighlights() {
  drawHighlightsOnLayer(allcanvas.front);
  drawHighlightsOnLayer(allcanvas.back);
}

function drawBackground(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.bg);
    clearCanvas(canvasdict.fab);
    clearCanvas(canvasdict.silk);
  }

  drawNets(canvasdict.bg, canvasdict.layer, false);
  drawFootprints(canvasdict.bg, canvasdict.layer,
    canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawEdgeCuts(canvasdict.bg, canvasdict.transform.s * canvasdict.transform.zoom);

  var style = getComputedStyle(topmostdiv);
  var edgeColor = style.getPropertyValue('--silkscreen-edge-color');
  var polygonColor = style.getPropertyValue('--silkscreen-polygon-color');
  var textColor = style.getPropertyValue('--silkscreen-text-color');
  if (settings.renderSilkscreen) {
    drawBgLayer(
      "silkscreen", canvasdict.silk, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
  edgeColor = style.getPropertyValue('--fabrication-edge-color');
  polygonColor = style.getPropertyValue('--fabrication-polygon-color');
  textColor = style.getPropertyValue('--fabrication-text-color');
  if (settings.renderFabrication) {
    drawBgLayer(
      "fabrication", canvasdict.fab, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
}

function prepareCanvas(canvas, flip, transform) {
  var ctx = canvas.getContext("2d");
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  ctx.scale(transform.zoom, transform.zoom);
  ctx.translate(transform.panx, transform.pany);
  if (flip) {
    ctx.scale(-1, 1);
  }
  ctx.translate(transform.x, transform.y);
  ctx.rotate(deg2rad(settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  ctx.scale(transform.s, transform.s);
}

function prepareLayer(canvasdict) {
  var flip = (canvasdict.layer === "B");
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    prepareCanvas(canvasdict[c], flip, canvasdict.transform);
  }
}

function rotateVector(v, angle) {
  angle = deg2rad(angle);
  return [
    v[0] * Math.cos(angle) - v[1] * Math.sin(angle),
    v[0] * Math.sin(angle) + v[1] * Math.cos(angle)
  ];
}

function applyRotation(bbox, flip) {
  var corners = [
    [bbox.minx, bbox.miny],
    [bbox.minx, bbox.maxy],
    [bbox.maxx, bbox.miny],
    [bbox.maxx, bbox.maxy],
  ];
  corners = corners.map((v) => rotateVector(v, settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  return {
    minx: corners.reduce((a, v) => Math.min(a, v[0]), Infinity),
    miny: corners.reduce((a, v) => Math.min(a, v[1]), Infinity),
    maxx: corners.reduce((a, v) => Math.max(a, v[0]), -Infinity),
    maxy: corners.reduce((a, v) => Math.max(a, v[1]), -Infinity),
  }
}

function recalcLayerScale(layerdict, width, height) {
  var flip = (layerdict.layer === "B");
  var bbox = applyRotation(pcbdata.edges_bbox, flip);
  var scalefactor = 0.98 * Math.min(
    width / (bbox.maxx - bbox.minx),
    height / (bbox.maxy - bbox.miny)
  );
  if (scalefactor < 0.1) {
    scalefactor = 1;
  }
  layerdict.transform.s = scalefactor;
  if (flip) {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor + width) * 0.5;
  } else {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor - width) * 0.5;
  }
  layerdict.transform.y = -((bbox.maxy + bbox.miny) * scalefactor - height) * 0.5;
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    canvas = layerdict[c];
    canvas.width = width;
    canvas.height = height;
    canvas.style.width = (width / devicePixelRatio) + "px";
    canvas.style.height = (height / devicePixelRatio) + "px";
  }
}

function redrawCanvas(layerdict) {
  prepareLayer(layerdict);
  drawBackground(layerdict);
  drawHighlightsOnLayer(layerdict);
}

function resizeCanvas(layerdict) {
  var canvasdivid = {
    "F": "frontcanvas",
    "B": "backcanvas"
  } [layerdict.layer];
  var width = document.getElementById(canvasdivid).clientWidth * devicePixelRatio;
  var height = document.getElementById(canvasdivid).clientHeight * devicePixelRatio;
  recalcLayerScale(layerdict, width, height);
  redrawCanvas(layerdict);
}

function resizeAll() {
  resizeCanvas(allcanvas.front);
  resizeCanvas(allcanvas.back);
}

function pointWithinDistanceToSegment(x, y, x1, y1, x2, y2, d) {
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var dx, dy;
  if (len_sq == 0) {
    // start and end of the segment coincide
    dx = x - x1;
    dy = y - y1;
  } else {
    var param = dot / len_sq;
    var xx, yy;
    if (param < 0) {
      xx = x1;
      yy = y1;
    } else if (param > 1) {
      xx = x2;
      yy = y2;
    } else {
      xx = x1 + param * C;
      yy = y1 + param * D;
    }
    dx = x - xx;
    dy = y - yy;
  }
  return dx * dx + dy * dy <= d * d;
}

function modulo(n, mod) {
  return ((n % mod) + mod) % mod;
}

function pointWithinDistanceToArc(x, y, xc, yc, radius, startangle, endangle, d) {
  var dx = x - xc;
  var dy = y - yc;
  var r_sq = dx * dx + dy * dy;
  var rmin = Math.max(0, radius - d);
  var rmax = radius + d;

  if (r_sq < rmin * rmin || r_sq > rmax * rmax)
    return false;

  var angle1 = modulo(deg2rad(startangle), 2 * Math.PI);
  var dx1 = xc + radius * Math.cos(angle1) - x;
  var dy1 = yc + radius * Math.sin(angle1) - y;
  if (dx1 * dx1 + dy1 * dy1 <= d * d)
    return true;

  var angle2 = modulo(deg2rad(endangle), 2 * Math.PI);
  var dx2 = xc + radius * Math.cos(angle2) - x;
  var dy2 = yc + radius * Math.sin(angle2) - y;
  if (dx2 * dx2 + dy2 * dy2 <= d * d)
    return true;

  var angle = modulo(Math.atan2(dy, dx), 2 * Math.PI);
  if (angle1 > angle2)
    return (angle >= angle2 || angle <= angle1);
  else
    return (angle >= angle1 && angle <= angle2);
}

function pointWithinPad(x, y, pad) {
  var v = [x - pad.pos[0], y - pad.pos[1]];
  v = rotateVector(v, pad.angle);
  if (pad.offset) {
    v[0] -= pad.offset[0];
    v[1] -= pad.offset[1];
  }
  return emptyContext2d.isPointInPath(getCachedPadPath(pad), ...v);
}

function netHitScan(layer, x, y) {
  // Check track segments
  if (settings.renderTracks && pcbdata.tracks) {
    for (var track of pcbdata.tracks[layer]) {
      if ('radius' in track) {
        if (pointWithinDistanceToArc(x, y, ...track.center, track.radius, track.startangle, track.endangle, track.width / 2)) {
          return track.net;
        }
      } else {
        if (pointWithinDistanceToSegment(x, y, ...track.start, ...track.end, track.width / 2)) {
          return track.net;
        }
      }
    }
  }
  // Check pads
  if (settings.renderPads) {
    for (var footprint of pcbdata.footprints) {
      for (var pad of footprint.pads) {
        if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
          return pad.net;
        }
      }
    }
  }
  return null;
}

function pointWithinFootprintBbox(x, y, bbox) {
  var v = [x - bbox.pos[0], y - bbox.pos[1]];
  v = rotateVector(v, bbox.angle);
  return bbox.relpos[0] <= v[0] && v[0] <= bbox.relpos[0] + bbox.size[0] &&
    bbox.relpos[1] <= v[1] && v[1] <= bbox.relpos[1] + bbox.size[1];
}

function bboxHitScan(layer, x, y) {
  var result = [];
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var footprint = pcbdata.footprints[i];
    if (footprint.layer == layer) {
      if (pointWithinFootprintBbox(x, y, footprint.bbox)) {
        result.push(i);
      }
    }
  }
  return result;
}

function handlePointerDown(e, layerdict) {
  if (e.button != 0 && e.button != 1) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  layerdict.pointerStates[e.pointerId] = {
    distanceTravelled: 0,
    lastX: e.offsetX,
    lastY: e.offsetY,
    downTime: Date.now(),
  };
}

function handleMouseClick(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var x = e.offsetX;
  var y = e.offsetY;
  var t = layerdict.transform;
  var flip = layerdict.layer === "B";
  if (flip) {
    x = (devicePixelRatio * x / t.zoom - t.panx + t.x) / -t.s;
  } else {
    x = (devicePixelRatio * x / t.zoom - t.panx - t.x) / t.s;
  }
  y = (devicePixelRatio * y / t.zoom - t.y - t.pany) / t.s;
  var v = rotateVector([x, y], -settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0));
  if ("nets" in pcbdata) {
    var net = netHitScan(layerdict.layer, ...v);
    if (net !== highlightedNet) {
      netClicked(net);
    }
  }
  if (highlightedNet === null) {
    var footprints = bboxHitScan(layerdict.layer, ...v);
    if (footprints.length > 0) {
      footprintsClicked(footprints);
    }
  }
}

function handlePointerLeave(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();

  if (!settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }

  delete layerdict.pointerStates[e.pointerId];
}

function resetTransform(layerdict) {
  layerdict.transform.panx = 0;
  layerdict.transform.pany = 0;
  layerdict.transform.zoom = 1;
  redrawCanvas(layerdict);
}

function handlePointerUp(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  e.preventDefault();
  e.stopPropagation();

  if (e.button == 2) {
    // Reset pan and zoom on right click.
    resetTransform(layerdict);
    layerdict.anotherPointerTapped = false;
    return;
  }

  // We haven't necessarily had a pointermove event since the interaction started, so make sure we update this now
  var ptr = layerdict.pointerStates[e.pointerId];
  ptr.distanceTravelled += Math.abs(e.offsetX - ptr.lastX) + Math.abs(e.offsetY - ptr.lastY);

  if (e.button == 0 && ptr.distanceTravelled < 10 && Date.now() - ptr.downTime <= 500) {
    if (Object.keys(layerdict.pointerStates).length == 1) {
      if (layerdict.anotherPointerTapped) {
        // This is the second pointer coming off of a two-finger tap
        resetTransform(layerdict);
      } else {
        // This is just a regular tap
        handleMouseClick(e, layerdict);
      }
      layerdict.anotherPointerTapped = false;
    } else {
      // This is the first finger coming off of what could become a two-finger tap
      layerdict.anotherPointerTapped = true;
    }
  } else {
    if (!settings.redrawOnDrag) {
      redrawCanvas(layerdict);
    }
    layerdict.anotherPointerTapped = false;
  }

  delete layerdict.pointerStates[e.pointerId];
}

function handlePointerMove(e, layerdict) {
  if (!layerdict.pointerStates.hasOwnProperty(e.pointerId)) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var thisPtr = layerdict.pointerStates[e.pointerId];

  var dx = e.offsetX - thisPtr.lastX;
  var dy = e.offsetY - thisPtr.lastY;

  // If this number is low on pointer up, we count the action as a click
  thisPtr.distanceTravelled += Math.abs(dx) + Math.abs(dy);

  if (Object.keys(layerdict.pointerStates).length == 1) {
    // This is a simple drag
    layerdict.transform.panx += devicePixelRatio * dx / layerdict.transform.zoom;
    layerdict.transform.pany += devicePixelRatio * dy / layerdict.transform.zoom;
  } else if (Object.keys(layerdict.pointerStates).length == 2) {
    var otherPtr = Object.values(layerdict.pointerStates).filter((ptr) => ptr != thisPtr)[0];

    var oldDist = Math.sqrt(Math.pow(thisPtr.lastX - otherPtr.lastX, 2) + Math.pow(thisPtr.lastY - otherPtr.lastY, 2));
    var newDist = Math.sqrt(Math.pow(e.offsetX - otherPtr.lastX, 2) + Math.pow(e.offsetY - otherPtr.lastY, 2));

    var scaleFactor = newDist / oldDist;

    if (scaleFactor != NaN) {
      layerdict.transform.zoom *= scaleFactor;

      var zoomd = (1 - scaleFactor) / layerdict.transform.zoom;
      layerdict.transform.panx += devicePixelRatio * otherPtr.lastX * zoomd;
      layerdict.transform.pany += devicePixelRatio * otherPtr.lastY * zoomd;
    }
  }

  thisPtr.lastX = e.offsetX;
  thisPtr.lastY = e.offsetY;

  if (settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }
}

function handleMouseWheel(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();
  var t = layerdict.transform;
  var wheeldelta = e.deltaY;
  if (e.deltaMode == 1) {
    // FF only, scroll by lines
    wheeldelta *= 30;
  } else if (e.deltaMode == 2) {
    wheeldelta *= 300;
  }
  var m = Math.pow(1.1, -wheeldelta / 40);
  // Limit amount of zoom per tick.
  if (m > 2) {
    m = 2;
  } else if (m < 0.5) {
    m = 0.5;
  }
  t.zoom *= m;
  var zoomd = (1 - m) / t.zoom;
  t.panx += devicePixelRatio * e.offsetX * zoomd;
  t.pany += devicePixelRatio * e.offsetY * zoomd;
  redrawCanvas(layerdict);
}

function addMouseHandlers(div, layerdict) {
  div.addEventListener("pointerdown", function(e) {
    handlePointerDown(e, layerdict);
  });
  div.addEventListener("pointermove", function(e) {
    handlePointerMove(e, layerdict);
  });
  div.addEventListener("pointerup", function(e) {
    handlePointerUp(e, layerdict);
  });
  var pointerleave = function(e) {
    handlePointerLeave(e, layerdict);
  }
  div.addEventListener("pointercancel", pointerleave);
  div.addEventListener("pointerleave", pointerleave);
  div.addEventListener("pointerout", pointerleave);

  div.onwheel = function(e) {
    handleMouseWheel(e, layerdict);
  }
  for (var element of [div, layerdict.bg, layerdict.fab, layerdict.silk, layerdict.highlight]) {
    element.addEventListener("contextmenu", function(e) {
      e.preventDefault();
    }, false);
  }
}

function setRedrawOnDrag(value) {
  settings.redrawOnDrag = value;
  writeStorage("redrawOnDrag", value);
}

function setBoardRotation(value) {
  settings.boardRotation = value * 5;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  resizeAll();
}

function setOffsetBackRotation(value) {
  settings.offsetBackRotation = value;
  writeStorage("offsetBackRotation", value);
  resizeAll();
}

function initRender() {
  allcanvas = {
    front: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("F_bg"),
      fab: document.getElementById("F_fab"),
      silk: document.getElementById("F_slk"),
      highlight: document.getElementById("F_hl"),
      layer: "F",
    },
    back: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("B_bg"),
      fab: document.getElementById("B_fab"),
      silk: document.getElementById("B_slk"),
      highlight: document.getElementById("B_hl"),
      layer: "B",
    }
  };
  addMouseHandlers(document.getElementById("frontcanvas"), allcanvas.front);
  addMouseHandlers(document.getElementById("backcanvas"), allcanvas.back);
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/*
 * Table reordering via Drag'n'Drop
 * Inspired by: https://htmldom.dev/drag-and-drop-table-column
 */

function setBomHandlers() {

  const bom = document.getElementById('bomtable');

  let dragName;
  let placeHolderElements;
  let draggingElement;
  let forcePopulation;
  let xOffset;
  let yOffset;
  let wasDragged;

  const mouseUpHandler = function(e) {
    // Delete dragging element
    draggingElement.remove();

    // Make BOM selectable again
    bom.style.removeProperty("user-select");

    // Remove listeners
    document.removeEventListener('mousemove', mouseMoveHandler);
    document.removeEventListener('mouseup', mouseUpHandler);

    if (wasDragged) {
      // Redraw whole BOM
      populateBomTable();
    }
  }

  const mouseMoveHandler = function(e) {
    // Notice the dragging
    wasDragged = true;

    // Make the dragged element visible
    draggingElement.style.removeProperty("display");

    // Set elements position to mouse position
    draggingElement.style.left = `${e.screenX - xOffset}px`;
    draggingElement.style.top = `${e.screenY - yOffset}px`;

    // Forced redrawing of BOM table
    if (forcePopulation) {
      forcePopulation = false;
      // Copy array
      phe = Array.from(placeHolderElements);
      // populate BOM table again
      populateBomHeader(dragName, phe);
      populateBomBody(dragName, phe);
    }

    // Set up array of hidden columns
    var hiddenColumns = Array.from(settings.hiddenColumns);
    // In the ungrouped mode, quantity don't exist
    if (settings.bommode === "ungrouped")
      hiddenColumns.push("Quantity");
    // If no checkbox fields can be found, we consider them hidden
    if (settings.checkboxes.length == 0)
      hiddenColumns.push("checkboxes");

    // Get table headers and group them into checkboxes, extrafields and normal headers
    const bh = document.getElementById("bomhead");
    headers = Array.from(bh.querySelectorAll("th"))
    headers.shift() // numCol is not part of the columnOrder
    headerGroups = []
    lastCompoundClass = null;
    for (i = 0; i < settings.columnOrder.length; i++) {
      cElem = settings.columnOrder[i];
      if (hiddenColumns.includes(cElem)) {
        // Hidden columns appear as a dummy element
        headerGroups.push([]);
        continue;
      }
      elem = headers.filter(e => getColumnOrderName(e) === cElem)[0];
      if (elem.classList.contains("bom-checkbox")) {
        if (lastCompoundClass === "bom-checkbox") {
          cbGroup = headerGroups.pop();
          cbGroup.push(elem);
          headerGroups.push(cbGroup);
        } else {
          lastCompoundClass = "bom-checkbox";
          headerGroups.push([elem])
        }
      } else {
        headerGroups.push([elem])
      }
    }

    // Copy settings.columnOrder
    var columns = Array.from(settings.columnOrder)

    // Set up array with indices of hidden columns
    var hiddenIndices = hiddenColumns.map(e => settings.columnOrder.indexOf(e));
    var dragIndex = columns.indexOf(dragName);
    var swapIndex = dragIndex;
    var swapDone = false;

    // Check if the current dragged element is swapable with the left or right element
    if (dragIndex > 0) {
      // Get left headers boundingbox
      swapIndex = dragIndex - 1;
      while (hiddenIndices.includes(swapIndex) && swapIndex > 0)
        swapIndex--;
      if (!hiddenIndices.includes(swapIndex)) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX < box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }
    if ((!swapDone) && dragIndex < headerGroups.length - 1) {
      // Get right headers boundingbox
      swapIndex = dragIndex + 1;
      while (hiddenIndices.includes(swapIndex))
        swapIndex++;
      if (swapIndex < headerGroups.length) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX > box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }

    // Write back change to storage
    if (swapDone) {
      settings.columnOrder = columns
      writeStorage("columnOrder", JSON.stringify(columns));
    }

  }

  const mouseDownHandler = function(e) {
    var target = e.target;
    if (target.tagName.toLowerCase() != "td")
      target = target.parentElement;

    // Used to check if a dragging has ever happened
    wasDragged = false;

    // Create new element which will be displayed as the dragged column
    draggingElement = document.createElement("div")
    draggingElement.classList.add("dragging");
    draggingElement.style.display = "none";
    draggingElement.style.position = "absolute";
    draggingElement.style.overflow = "hidden";

    // Get bomhead and bombody elements
    const bh = document.getElementById("bomhead");
    const bb = document.getElementById("bombody");

    // Get all compound headers for the current column
    var compoundHeaders;
    if (target.classList.contains("bom-checkbox")) {
      compoundHeaders = Array.from(bh.querySelectorAll("th.bom-checkbox"));
    } else {
      compoundHeaders = [target];
    }

    // Create new table which will display the column
    var newTable = document.createElement("table");
    newTable.classList.add("bom");
    newTable.style.background = "white";
    draggingElement.append(newTable);

    // Create new header element
    var newHeader = document.createElement("thead");
    newTable.append(newHeader);

    // Set up array for storing all placeholder elements
    placeHolderElements = [];

    // Add all compound headers to the new thead element and placeholders
    compoundHeaders.forEach(function(h) {
      clone = cloneElementWithDimensions(h);
      newHeader.append(clone);
      placeHolderElements.push(clone);
    });

    // Create new body element
    var newBody = document.createElement("tbody");
    newTable.append(newBody);

    // Get indices for compound headers
    var idxs = compoundHeaders.map(e => getBomTableHeaderIndex(e));

    // For each row in the BOM body...
    var rows = bb.querySelectorAll("tr");
    rows.forEach(function(row) {
      // ..get the cells for the compound column
      const tds = row.querySelectorAll("td");
      var copytds = idxs.map(i => tds[i]);
      // Add them to the new element and the placeholders
      var newRow = document.createElement("tr");
      copytds.forEach(function(td) {
        clone = cloneElementWithDimensions(td);
        newRow.append(clone);
        placeHolderElements.push(clone);
      });
      newBody.append(newRow);
    });

    // Compute width for compound header
    var width = compoundHeaders.reduce((acc, x) => acc + x.clientWidth, 0);
    draggingElement.style.width = `${width}px`;

    // Insert the new dragging element and disable selection on BOM
    bom.insertBefore(draggingElement, null);
    bom.style.userSelect = "none";

    // Determine the mouse position offset
    xOffset = e.screenX - compoundHeaders.reduce((acc, x) => Math.min(acc, x.offsetLeft), compoundHeaders[0].offsetLeft);
    yOffset = e.screenY - compoundHeaders[0].offsetTop;

    // Get name for the column in settings.columnOrder
    dragName = getColumnOrderName(target);

    // Change text and class for placeholder elements
    placeHolderElements = placeHolderElements.map(function(e) {
      newElem = cloneElementWithDimensions(e);
      newElem.textContent = "";
      newElem.classList.add("placeholder");
      return newElem;
    });

    // On next mouse move, the whole BOM needs to be redrawn to show the placeholders
    forcePopulation = true;

    // Add listeners for move and up on mouse
    document.addEventListener('mousemove', mouseMoveHandler);
    document.addEventListener('mouseup', mouseUpHandler);
  }

  // In netlist mode, there is nothing to reorder
  if (settings.bommode === "netlist")
    return;

  // Add mouseDownHandler to every column except the numCol
  bom.querySelectorAll("th")
    .forEach(function(head) {
      if (!head.classList.contains("numCol")) {
        head.onmousedown = mouseDownHandler;
      }
    });

}

function getBoundingClientRectFromMultiple(elements) {
  var elems = Array.from(elements);

  if (elems.length == 0)
    return null;

  var box = elems.shift()
    .getBoundingClientRect();

  elems.forEach(function(elem) {
    var elembox = elem.getBoundingClientRect();
    box.left = Math.min(elembox.left, box.left);
    box.top = Math.min(elembox.top, box.top);
    box.width += elembox.width;
    box.height = Math.max(elembox.height, box.height);
  });

  return box;
}

function cloneElementWithDimensions(elem) {
  var newElem = elem.cloneNode(true);
  newElem.style.height = window.getComputedStyle(elem).height;
  newElem.style.width = window.getComputedStyle(elem).width;
  return newElem;
}

function getBomTableHeaderIndex(elem) {
  const bh = document.getElementById('bomhead');
  const ths = Array.from(bh.querySelectorAll("th"));
  return ths.indexOf(elem);
}

function getColumnOrderName(elem) {
  var cname = elem.getAttribute("col_name");
  if (cname === "bom-checkbox")
    return "checkboxes";
  else
    return cname;
}

function resizableGrid(tablehead) {
  var cols = tablehead.firstElementChild.children;
  var rowWidth = tablehead.offsetWidth;

  for (var i = 1; i < cols.length; i++) {
    if (cols[i].classList.contains("bom-checkbox"))
      continue;
    cols[i].style.width = ((cols[i].clientWidth - paddingDiff(cols[i])) * 100 / rowWidth) + '%';
  }

  for (var i = 1; i < cols.length - 1; i++) {
    var div = document.createElement('div');
    div.className = "column-width-handle";
    cols[i].appendChild(div);
    setListeners(div);
  }

  function setListeners(div) {
    var startX, curCol, nxtCol, curColWidth, nxtColWidth, rowWidth;

    div.addEventListener('mousedown', function(e) {
      e.preventDefault();
      e.stopPropagation();

      curCol = e.target.parentElement;
      nxtCol = curCol.nextElementSibling;
      startX = e.pageX;

      var padding = paddingDiff(curCol);

      rowWidth = curCol.parentElement.offsetWidth;
      curColWidth = curCol.clientWidth - padding;
      nxtColWidth = nxtCol.clientWidth - padding;
    });

    document.addEventListener('mousemove', function(e) {
      if (startX) {
        var diffX = e.pageX - startX;
        diffX = -Math.min(-diffX, curColWidth - 20);
        diffX = Math.min(diffX, nxtColWidth - 20);

        curCol.style.width = ((curColWidth + diffX) * 100 / rowWidth) + '%';
        nxtCol.style.width = ((nxtColWidth - diffX) * 100 / rowWidth) + '%';
        console.log(`${curColWidth + nxtColWidth} ${(curColWidth + diffX) * 100 / rowWidth + (nxtColWidth - diffX) * 100 / rowWidth}`);
      }
    });

    document.addEventListener('mouseup', function(e) {
      curCol = undefined;
      nxtCol = undefined;
      startX = undefined;
      nxtColWidth = undefined;
      curColWidth = undefined
    });
  }

  function paddingDiff(col) {

    if (getStyleVal(col, 'box-sizing') == 'border-box') {
      return 0;
    }

    var padLeft = getStyleVal(col, 'padding-left');
    var padRight = getStyleVal(col, 'padding-right');
    return (parseInt(padLeft) + parseInt(padRight));

  }

  function getStyleVal(elm, css) {
    return (window.getComputedStyle(elm, null).getPropertyValue(css))
  }
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/* DOM manipulation and misc code */

var bomsplit;
var canvassplit;
var initDone = false;
var bomSortFunction = null;
var currentSortColumn = null;
var currentSortOrder = null;
var currentHighlightedRowId;
var highlightHandlers = [];
var footprintIndexToHandler = {};
var netsToHandler = {};
var markedFootprints = new Set();
var highlightedFootprints = [];
var highlightedNet = null;
var lastClicked;

function dbg(html) {
  dbgdiv.innerHTML = html;
}

function redrawIfInitDone() {
  if (initDone) {
    redrawCanvas(allcanvas.front);
    redrawCanvas(allcanvas.back);
  }
}

function padsVisible(value) {
  writeStorage("padsVisible", value);
  settings.renderPads = value;
  redrawIfInitDone();
}

function referencesVisible(value) {
  writeStorage("referencesVisible", value);
  settings.renderReferences = value;
  redrawIfInitDone();
}

function valuesVisible(value) {
  writeStorage("valuesVisible", value);
  settings.renderValues = value;
  redrawIfInitDone();
}

function tracksVisible(value) {
  writeStorage("tracksVisible", value);
  settings.renderTracks = value;
  redrawIfInitDone();
}

function zonesVisible(value) {
  writeStorage("zonesVisible", value);
  settings.renderZones = value;
  redrawIfInitDone();
}

function dnpOutline(value) {
  writeStorage("dnpOutline", value);
  settings.renderDnpOutline = value;
  redrawIfInitDone();
}

function setDarkMode(value) {
  if (value) {
    topmostdiv.classList.add("dark");
  } else {
    topmostdiv.classList.remove("dark");
  }
  writeStorage("darkmode", value);
  settings.darkMode = value;
  redrawIfInitDone();
  if (initDone) {
    populateBomTable();
  }
}

function setShowBOMColumn(field, value) {
  if (field === "references") {
    var rl = document.getElementById("reflookup");
    rl.disabled = !value;
    if (!value) {
      rl.value = "";
      updateRefLookup("");
    }
  }

  var n = settings.hiddenColumns.indexOf(field);
  if (value) {
    if (n != -1) {
      settings.hiddenColumns.splice(n, 1);
    }
  } else {
    if (n == -1) {
      settings.hiddenColumns.push(field);
    }
  }

  writeStorage("hiddenColumns", JSON.stringify(settings.hiddenColumns));

  if (initDone) {
    populateBomTable();
  }

  redrawIfInitDone();
}


function setFullscreen(value) {
  if (value) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}

function fabricationVisible(value) {
  writeStorage("fabricationVisible", value);
  settings.renderFabrication = value;
  redrawIfInitDone();
}

function silkscreenVisible(value) {
  writeStorage("silkscreenVisible", value);
  settings.renderSilkscreen = value;
  redrawIfInitDone();
}

function setHighlightPin1(value) {
  writeStorage("highlightpin1", value);
  settings.highlightpin1 = value;
  redrawIfInitDone();
}

function setHighlightRowOnClick(value) {
  settings.highlightRowOnClick = value;
  writeStorage("highlightRowOnClick", value);
  if (initDone) {
    populateBomTable();
  }
}

function getStoredCheckboxRefs(checkbox) {
  function convert(ref) {
    var intref = parseInt(ref);
    if (isNaN(intref)) {
      for (var i = 0; i < pcbdata.footprints.length; i++) {
        if (pcbdata.footprints[i].ref == ref) {
          return i;
        }
      }
      return -1;
    } else {
      return intref;
    }
  }
  if (!(checkbox in settings.checkboxStoredRefs)) {
    var val = readStorage("checkbox_" + checkbox);
    settings.checkboxStoredRefs[checkbox] = val ? val : "";
  }
  if (!settings.checkboxStoredRefs[checkbox]) {
    return new Set();
  } else {
    return new Set(settings.checkboxStoredRefs[checkbox].split(",").map(r => convert(r)).filter(a => a >= 0));
  }
}

function getCheckboxState(checkbox, references) {
  var storedRefsSet = getStoredCheckboxRefs(checkbox);
  var currentRefsSet = new Set(references.map(r => r[1]));
  // Get difference of current - stored
  var difference = new Set(currentRefsSet);
  for (ref of storedRefsSet) {
    difference.delete(ref);
  }
  if (difference.size == 0) {
    // All the current refs are stored
    return "checked";
  } else if (difference.size == currentRefsSet.size) {
    // None of the current refs are stored
    return "unchecked";
  } else {
    // Some of the refs are stored
    return "indeterminate";
  }
}

function setBomCheckboxState(checkbox, element, references) {
  var state = getCheckboxState(checkbox, references);
  element.checked = (state == "checked");
  element.indeterminate = (state == "indeterminate");
}

function createCheckboxHandlers(input, checkbox, references, row) {
  var clickHandler = () => {
    refsSet = getStoredCheckboxRefs(checkbox);
    var markWhenChecked = settings.markWhenChecked == checkbox;
    eventArgs = {
      checkbox: checkbox,
      refs: references,
    }
    if (input.checked) {
      // checkbox ticked
      for (var ref of references) {
        refsSet.add(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.add("checked");
        for (var ref of references) {
          markedFootprints.add(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'checked';
    } else {
      // checkbox unticked
      for (var ref of references) {
        refsSet.delete(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.remove("checked");
        for (var ref of references) {
          markedFootprints.delete(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'unchecked';
    }
    settings.checkboxStoredRefs[checkbox] = [...refsSet].join(",");
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
    updateCheckboxStats(checkbox);
    EventHandler.emitEvent(IBOM_EVENT_TYPES.CHECKBOX_CHANGE_EVENT, eventArgs);
  }

  return [
    (e) => {
      clickHandler();
    },
    (e) => {
      e.preventDefault();
      if (row.onmousemove) row.onmousemove();
    },
    (e) => {
      e.preventDefault();
      input.checked = !input.checked;
      input.indeterminate = false;
      clickHandler();
    }
  ];
}

function clearHighlightedFootprints() {
  if (currentHighlightedRowId) {
    document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    currentHighlightedRowId = null;
    highlightedFootprints = [];
    highlightedNet = null;
  }
}

function createRowHighlightHandler(rowid, refs, net) {
  return function () {
    if (currentHighlightedRowId) {
      if (currentHighlightedRowId == rowid) {
        return;
      }
      document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    }
    document.getElementById(rowid).classList.add("highlighted");
    currentHighlightedRowId = rowid;
    highlightedFootprints = refs ? refs.map(r => r[1]) : [];
    highlightedNet = net;
    drawHighlights();
    EventHandler.emitEvent(
      IBOM_EVENT_TYPES.HIGHLIGHT_EVENT, {
      rowid: rowid,
      refs: refs,
      net: net
    });
  }
}

function updateNetColors() {
  writeStorage("netColors", JSON.stringify(settings.netColors));
  redrawIfInitDone();
}

function netColorChangeHandler(net) {
  return (event) => {
    settings.netColors[net] = event.target.value;
    updateNetColors();
  }
}

function netColorRightClick(net) {
  return (event) => {
    if (event.button == 2) {
      event.preventDefault();
      event.stopPropagation();

      var style = getComputedStyle(topmostdiv);
      var defaultNetColor = style.getPropertyValue('--track-color').trim();
      event.target.value = defaultNetColor;
      delete settings.netColors[net];
      updateNetColors();
    }
  }
}

function entryMatches(entry) {
  if (settings.bommode == "netlist") {
    // entry is just a net name
    return entry.toLowerCase().indexOf(filter) >= 0;
  }
  // check refs
  if (!settings.hiddenColumns.includes("References")) {
    for (var ref of entry) {
      if (ref[0].toLowerCase().indexOf(filter) >= 0) {
        return true;
      }
    }
  }
  // check fields
  for (var i in config.fields) {
    var f = config.fields[i];
    if (!settings.hiddenColumns.includes(f)) {
      for (var ref of entry) {
        if (String(pcbdata.bom.fields[ref[1]][i]).toLowerCase().indexOf(filter) >= 0) {
          return true;
        }
      }
    }
  }
  return false;
}

function findRefInEntry(entry) {
  return entry.filter(r => r[0].toLowerCase() == reflookup);
}

function highlightFilter(s) {
  if (!filter) {
    return s;
  }
  var parts = s.toLowerCase().split(filter);
  if (parts.length == 1) {
    return s;
  }
  var r = "";
  var pos = 0;
  for (var i in parts) {
    if (i > 0) {
      r += '<mark class="highlight">' +
        s.substring(pos, pos + filter.length) +
        '</mark>';
      pos += filter.length;
    }
    r += s.substring(pos, pos + parts[i].length);
    pos += parts[i].length;
  }
  return r;
}

function getBomListByLayer(layer) {
  switch (layer) {
    case 'F': return pcbdata.bom.F.slice();
    case 'B': return pcbdata.bom.B.slice();
    case 'FB': return pcbdata.bom.both.slice();
  }
  return [];
}

function getSelectedBomList() {
  if (settings.bommode == "netlist") {
    return pcbdata.nets.slice();
  }
  var out = getBomListByLayer(settings.canvaslayout);

  if (settings.bommode == "ungrouped") {
    // expand bom table
    var expandedTable = [];
    for (var bomentry of out) {
      for (var ref of bomentry) {
        expandedTable.push([ref]);
      }
    }
    return expandedTable;
  }

  return out;
}

function checkboxSetUnsetAllHandler(checkboxname) {
  return function () {
    var checkboxnum = 0;
    while (checkboxnum < settings.checkboxes.length &&
      settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
      checkboxnum++;
    }
    if (checkboxnum >= settings.checkboxes.length) {
      return;
    }
    var allset = true;
    var checkbox;
    var row;
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      if (!checkbox.checked || checkbox.indeterminate) {
        allset = false;
        break;
      }
    }
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      checkbox.checked = !allset;
      checkbox.indeterminate = false;
      checkbox.onchange();
    }
  }
}

function createColumnHeader(name, cls, comparator, is_checkbox = false) {
  var th = document.createElement("TH");
  th.innerHTML = name;
  th.classList.add(cls);
  if (is_checkbox)
    th.setAttribute("col_name", "bom-checkbox");
  else
    th.setAttribute("col_name", name);
  var span = document.createElement("SPAN");
  span.classList.add("sortmark");
  span.classList.add("none");
  th.appendChild(span);
  var spacer = document.createElement("div");
  spacer.className = "column-spacer";
  th.appendChild(spacer);
  spacer.onclick = function () {
    if (currentSortColumn && th !== currentSortColumn) {
      // Currently sorted by another column
      currentSortColumn.childNodes[1].classList.remove(currentSortOrder);
      currentSortColumn.childNodes[1].classList.add("none");
      currentSortColumn = null;
      currentSortOrder = null;
    }
    if (currentSortColumn && th === currentSortColumn) {
      // Already sorted by this column
      if (currentSortOrder == "asc") {
        // Sort by this column, descending order
        bomSortFunction = function (a, b) {
          return -comparator(a, b);
        }
        currentSortColumn.childNodes[1].classList.remove("asc");
        currentSortColumn.childNodes[1].classList.add("desc");
        currentSortOrder = "desc";
      } else {
        // Unsort
        bomSortFunction = null;
        currentSortColumn.childNodes[1].classList.remove("desc");
        currentSortColumn.childNodes[1].classList.add("none");
        currentSortColumn = null;
        currentSortOrder = null;
      }
    } else {
      // Sort by this column, ascending order
      bomSortFunction = comparator;
      currentSortColumn = th;
      currentSortColumn.childNodes[1].classList.remove("none");
      currentSortColumn.childNodes[1].classList.add("asc");
      currentSortOrder = "asc";
    }
    populateBomBody();
  }
  if (is_checkbox) {
    spacer.onclick = fancyDblClickHandler(
      spacer, spacer.onclick, checkboxSetUnsetAllHandler(name));
  }
  return th;
}

function populateBomHeader(placeHolderColumn = null, placeHolderElements = null) {
  while (bomhead.firstChild) {
    bomhead.removeChild(bomhead.firstChild);
  }
  var tr = document.createElement("TR");
  var th = document.createElement("TH");
  th.classList.add("numCol");

  var vismenu = document.createElement("div");
  vismenu.id = "vismenu";
  vismenu.classList.add("menu");

  var visbutton = document.createElement("div");
  visbutton.classList.add("visbtn");
  visbutton.classList.add("hideonprint");

  var viscontent = document.createElement("div");
  viscontent.classList.add("menu-content");
  viscontent.id = "vismenu-content";

  settings.columnOrder.forEach(column => {
    if (typeof column !== "string")
      return;

    // Skip empty columns
    if (column === "checkboxes" && settings.checkboxes.length == 0)
      return;
    else if (column === "Quantity" && settings.bommode == "ungrouped")
      return;

    var label = document.createElement("label");
    label.classList.add("menu-label");

    var input = document.createElement("input");
    input.classList.add("visibility_checkbox");
    input.type = "checkbox";
    input.onchange = function (e) {
      setShowBOMColumn(column, e.target.checked)
    };
    input.checked = !(settings.hiddenColumns.includes(column));

    label.appendChild(input);
    if (column.length > 0)
      label.append(column[0].toUpperCase() + column.slice(1));

    viscontent.appendChild(label);
  });

  viscontent.childNodes[0].classList.add("menu-label-top");

  vismenu.appendChild(visbutton);
  if (settings.bommode != "netlist") {
    vismenu.appendChild(viscontent);
    th.appendChild(vismenu);
  }
  tr.appendChild(th);

  var checkboxCompareClosure = function (checkbox) {
    return (a, b) => {
      var stateA = getCheckboxState(checkbox, a);
      var stateB = getCheckboxState(checkbox, b);
      if (stateA > stateB) return -1;
      if (stateA < stateB) return 1;
      return 0;
    }
  }
  var stringFieldCompareClosure = function (fieldIndex) {
    return (a, b) => {
      var fa = pcbdata.bom.fields[a[0][1]][fieldIndex];
      var fb = pcbdata.bom.fields[b[0][1]][fieldIndex];
      if (fa != fb) return fa > fb ? 1 : -1;
      else return 0;
    }
  }
  var referenceRegex = /(?<prefix>[^0-9]+)(?<number>[0-9]+)/;
  var compareRefs = (a, b) => {
    var ra = referenceRegex.exec(a);
    var rb = referenceRegex.exec(b);
    if (ra === null || rb === null) {
      if (a != b) return a > b ? 1 : -1;
      return 0;
    } else {
      if (ra.groups.prefix != rb.groups.prefix) {
        return ra.groups.prefix > rb.groups.prefix ? 1 : -1;
      }
      if (ra.groups.number != rb.groups.number) {
        return parseInt(ra.groups.number) > parseInt(rb.groups.number) ? 1 : -1;
      }
      return 0;
    }
  }
  if (settings.bommode == "netlist") {
    tr.appendChild(createColumnHeader("Net name", "bom-netname", (a, b) => {
      if (a > b) return -1;
      if (a < b) return 1;
      return 0;
    }));
    tr.appendChild(createColumnHeader("Color", "bom-color", (a, b) => {
      return 0;
    }));
  } else {
    // Filter hidden columns
    var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
    var valueIndex = config.fields.indexOf("Value");
    var footprintIndex = config.fields.indexOf("Footprint");
    columns.forEach((column) => {
      if (column === placeHolderColumn) {
        var n = 1;
        if (column === "checkboxes")
          n = settings.checkboxes.length;
        for (i = 0; i < n; i++) {
          td = placeHolderElements.shift();
          tr.appendChild(td);
        }
        return;
      } else if (column === "checkboxes") {
        for (var checkbox of settings.checkboxes) {
          th = createColumnHeader(
            checkbox, "bom-checkbox", checkboxCompareClosure(checkbox), true);
          tr.appendChild(th);
        }
      } else if (column === "References") {
        tr.appendChild(createColumnHeader("References", "references", (a, b) => {
          var i = 0;
          while (i < a.length && i < b.length) {
            if (a[i][0] != b[i][0]) return compareRefs(a[i][0], b[i][0]);
            i++;
          }
          return a.length - b.length;
        }));
      } else if (column === "Value") {
        tr.appendChild(createColumnHeader("Value", "value", (a, b) => {
          var ra = a[0][1], rb = b[0][1];
          return valueCompare(
            pcbdata.bom.parsedValues[ra], pcbdata.bom.parsedValues[rb],
            pcbdata.bom.fields[ra][valueIndex], pcbdata.bom.fields[rb][valueIndex]);
        }));
        return;
      } else if (column === "Footprint") {
        tr.appendChild(createColumnHeader(
          "Footprint", "footprint", stringFieldCompareClosure(footprintIndex)));
      } else if (column === "Quantity" && settings.bommode == "grouped") {
        tr.appendChild(createColumnHeader("Quantity", "quantity", (a, b) => {
          return a.length - b.length;
        }));
      } else {
        // Other fields
        var i = config.fields.indexOf(column);
        if (i < 0)
          return;
        tr.appendChild(createColumnHeader(
          column, `field${i + 1}`, stringFieldCompareClosure(i)));
      }
    });
  }
  bomhead.appendChild(tr);
}

function populateBomBody(placeholderColumn = null, placeHolderElements = null) {
  const urlRegex = /^(https?:\/\/[^\s\/$.?#][^\s]*|file:\/\/([a-zA-Z]:|\/)[^\x00]+)$/;
  while (bom.firstChild) {
    bom.removeChild(bom.firstChild);
  }
  highlightHandlers = [];
  footprintIndexToHandler = {};
  netsToHandler = {};
  currentHighlightedRowId = null;
  var first = true;
  var style = getComputedStyle(topmostdiv);
  var defaultNetColor = style.getPropertyValue('--track-color').trim();

  bomtable = getSelectedBomList();

  if (bomSortFunction) {
    bomtable = bomtable.sort(bomSortFunction);
  }
  for (var i in bomtable) {
    var bomentry = bomtable[i];
    if (filter && !entryMatches(bomentry)) {
      continue;
    }
    var references = null;
    var netname = null;
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    var rownum = +i + 1;
    tr.id = "bomrow" + rownum;
    td.textContent = rownum;
    tr.appendChild(td);
    if (settings.bommode == "netlist") {
      netname = bomentry;
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(netname ? netname : "&lt;no net&gt;");
      tr.appendChild(td);
      var color = settings.netColors[netname] || defaultNetColor;
      td = document.createElement("TD");
      var colorBox = document.createElement("INPUT");
      colorBox.type = "color";
      colorBox.value = color;
      colorBox.onchange = netColorChangeHandler(netname);
      colorBox.onmouseup = netColorRightClick(netname);
      colorBox.oncontextmenu = (e) => e.preventDefault();
      td.appendChild(colorBox);
      td.classList.add("color-column");
      tr.appendChild(td);
    } else {
      if (reflookup) {
        references = findRefInEntry(bomentry);
        if (references.length == 0) {
          continue;
        }
      } else {
        references = bomentry;
      }
      // Filter hidden columns
      var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
      columns.forEach((column) => {
        if (column === placeholderColumn) {
          var n = 1;
          if (column === "checkboxes")
            n = settings.checkboxes.length;
          for (i = 0; i < n; i++) {
            td = placeHolderElements.shift();
            tr.appendChild(td);
          }
          return;
        } else if (column === "checkboxes") {
          for (var checkbox of settings.checkboxes) {
            if (checkbox) {
              td = document.createElement("TD");
              var input = document.createElement("input");
              input.type = "checkbox";
              [input.onchange, td.ontouchstart, td.ontouchend] = createCheckboxHandlers(input, checkbox, references, tr);
              setBomCheckboxState(checkbox, input, references);
              if (input.checked && settings.markWhenChecked == checkbox) {
                tr.classList.add("checked");
              }
              td.appendChild(input);
              tr.appendChild(td);
            }
          }
        } else if (column === "References") {
          td = document.createElement("TD");
          td.innerHTML = highlightFilter(references.map(r => r[0]).join(", "));
          tr.appendChild(td);
        } else if (column === "Quantity" && settings.bommode == "grouped") {
          // Quantity
          td = document.createElement("TD");
          td.textContent = references.length;
          tr.appendChild(td);
        } else {
          // All the other fields
          var field_index = config.fields.indexOf(column)
          if (field_index < 0)
            return;
          var valueSet = new Set();
          references.map(r => r[1]).forEach((id) => valueSet.add(pcbdata.bom.fields[id][field_index]));
          td = document.createElement("TD");
          var output = new Array();
          for (let item of valueSet) {
            const visible = highlightFilter(String(item));
            if (typeof item === 'string' && item.match(urlRegex)) {
              output.push(`<a href="${item}" target="_blank">${visible}</a>`);
            } else {
              output.push(visible);
            }
          }
          td.innerHTML = output.join(", ");
          tr.appendChild(td);
        }
      });
    }
    bom.appendChild(tr);
    var handler = createRowHighlightHandler(tr.id, references, netname);
    if (settings.highlightRowOnClick) {
      tr.onmousedown = handler;
    } else {
      tr.onmousemove = handler;
    }
    highlightHandlers.push({
      id: tr.id,
      handler: handler,
    });
    if (references !== null) {
      for (var refIndex of references.map(r => r[1])) {
        footprintIndexToHandler[refIndex] = handler;
      }
    }
    if (netname !== null) {
      netsToHandler[netname] = handler;
    }
    if ((filter || reflookup) && first) {
      handler();
      first = false;
    }
  }
  EventHandler.emitEvent(
    IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, {
    filter: filter,
    reflookup: reflookup,
    checkboxes: settings.checkboxes,
    bommode: settings.bommode,
  });
}

function highlightPreviousRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[highlightHandlers.length - 1].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[0].id == currentHighlightedRowId) {
      highlightHandlers[highlightHandlers.length - 1].handler();
    } else {
      for (var i = 0; i < highlightHandlers.length - 1; i++) {
        if (highlightHandlers[i + 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function highlightNextRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[0].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[highlightHandlers.length - 1].id == currentHighlightedRowId) {
      highlightHandlers[0].handler();
    } else {
      for (var i = 1; i < highlightHandlers.length; i++) {
        if (highlightHandlers[i - 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function populateBomTable() {
  populateBomHeader();
  populateBomBody();
  setBomHandlers();
  resizableGrid(bomhead);
}

function footprintsClicked(footprintIndexes) {
  var lastClickedIndex = footprintIndexes.indexOf(lastClicked);
  for (var i = 1; i <= footprintIndexes.length; i++) {
    var refIndex = footprintIndexes[(lastClickedIndex + i) % footprintIndexes.length];
    if (refIndex in footprintIndexToHandler) {
      lastClicked = refIndex;
      footprintIndexToHandler[refIndex]();
      smoothScrollToRow(currentHighlightedRowId);
      break;
    }
  }
}

function netClicked(net) {
  if (net in netsToHandler) {
    netsToHandler[net]();
    smoothScrollToRow(currentHighlightedRowId);
  } else {
    clearHighlightedFootprints();
    highlightedNet = net;
    drawHighlights();
  }
}

function updateFilter(input) {
  filter = input.toLowerCase();
  populateBomTable();
}

function updateRefLookup(input) {
  reflookup = input.toLowerCase();
  populateBomTable();
}

function changeCanvasLayout(layout) {
  document.getElementById("fl-btn").classList.remove("depressed");
  document.getElementById("fb-btn").classList.remove("depressed");
  document.getElementById("bl-btn").classList.remove("depressed");
  switch (layout) {
    case 'F':
      document.getElementById("fl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(1);
      }
      break;
    case 'B':
      document.getElementById("bl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(0);
      }
      break;
    default:
      document.getElementById("fb-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.setSizes([50, 50]);
      }
  }
  settings.canvaslayout = layout;
  writeStorage("canvaslayout", layout);
  resizeAll();
  changeBomMode(settings.bommode);
}

function populateMetadata() {
  document.getElementById("title").innerHTML = pcbdata.metadata.title;
  document.getElementById("revision").innerHTML = "Rev: " + pcbdata.metadata.revision;
  document.getElementById("company").innerHTML = pcbdata.metadata.company;
  document.getElementById("filedate").innerHTML = pcbdata.metadata.date;
  if (pcbdata.metadata.title != "") {
    document.title = pcbdata.metadata.title + " BOM";
  }
  // Calculate board stats
  var fp_f = 0,
    fp_b = 0,
    pads_f = 0,
    pads_b = 0,
    pads_th = 0;
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    if (pcbdata.bom.skipped.includes(i)) continue;
    var mod = pcbdata.footprints[i];
    if (mod.layer == "F") {
      fp_f++;
    } else {
      fp_b++;
    }
    for (var pad of mod.pads) {
      if (pad.type == "th") {
        pads_th++;
      } else {
        if (pad.layers.includes("F")) {
          pads_f++;
        }
        if (pad.layers.includes("B")) {
          pads_b++;
        }
      }
    }
  }
  document.getElementById("stats-components-front").innerHTML = fp_f;
  document.getElementById("stats-components-back").innerHTML = fp_b;
  document.getElementById("stats-components-total").innerHTML = fp_f + fp_b;
  document.getElementById("stats-groups-front").innerHTML = pcbdata.bom.F.length;
  document.getElementById("stats-groups-back").innerHTML = pcbdata.bom.B.length;
  document.getElementById("stats-groups-total").innerHTML = pcbdata.bom.both.length;
  document.getElementById("stats-smd-pads-front").innerHTML = pads_f;
  document.getElementById("stats-smd-pads-back").innerHTML = pads_b;
  document.getElementById("stats-smd-pads-total").innerHTML = pads_f + pads_b;
  document.getElementById("stats-th-pads").innerHTML = pads_th;
  // Update version string
  document.getElementById("github-link").innerHTML = "InteractiveHtmlBom&nbsp;" +
    /^v\d+\.\d+/.exec(pcbdata.ibom_version)[0];
}

function changeBomLayout(layout) {
  document.getElementById("bom-btn").classList.remove("depressed");
  document.getElementById("lr-btn").classList.remove("depressed");
  document.getElementById("tb-btn").classList.remove("depressed");
  switch (layout) {
    case 'bom-only':
      document.getElementById("bom-btn").classList.add("depressed");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      document.getElementById("frontcanvas").style.display = "none";
      document.getElementById("backcanvas").style.display = "none";
      document.getElementById("topmostdiv").style.height = "";
      document.getElementById("topmostdiv").style.display = "block";
      break;
    case 'top-bottom':
      document.getElementById("tb-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.remove("split-horizontal");
      document.getElementById("canvasdiv").classList.remove("split-horizontal");
      document.getElementById("frontcanvas").classList.add("split-horizontal");
      document.getElementById("backcanvas").classList.add("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        direction: "vertical",
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        onDragEnd: resizeAll
      });
      break;
    case 'left-right':
      document.getElementById("lr-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.add("split-horizontal");
      document.getElementById("canvasdiv").classList.add("split-horizontal");
      document.getElementById("frontcanvas").classList.remove("split-horizontal");
      document.getElementById("backcanvas").classList.remove("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        direction: "vertical",
        onDragEnd: resizeAll
      });
  }
  settings.bomlayout = layout;
  writeStorage("bomlayout", layout);
  changeCanvasLayout(settings.canvaslayout);
}

function changeBomMode(mode) {
  document.getElementById("bom-grouped-btn").classList.remove("depressed");
  document.getElementById("bom-ungrouped-btn").classList.remove("depressed");
  document.getElementById("bom-netlist-btn").classList.remove("depressed");
  var chkbxs = document.getElementsByClassName("visibility_checkbox");

  switch (mode) {
    case 'grouped':
      document.getElementById("bom-grouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'ungrouped':
      document.getElementById("bom-ungrouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'netlist':
      document.getElementById("bom-netlist-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = true;
      }
  }

  writeStorage("bommode", mode);
  if (mode != settings.bommode) {
    settings.bommode = mode;
    bomSortFunction = null;
    currentSortColumn = null;
    currentSortOrder = null;
    clearHighlightedFootprints();
  }
  populateBomTable();
}

function focusFilterField() {
  focusInputField(document.getElementById("filter"));
}

function focusRefLookupField() {
  focusInputField(document.getElementById("reflookup"));
}

function toggleBomCheckbox(bomrowid, checkboxnum) {
  if (!bomrowid || checkboxnum > settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var childNum = checkboxnum + settings.columnOrder.indexOf("checkboxes");
  var checkbox = bomrow.childNodes[childNum].childNodes[0];
  checkbox.checked = !checkbox.checked;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function checkBomCheckbox(bomrowid, checkboxname) {
  var checkboxnum = 0;
  while (checkboxnum < settings.checkboxes.length &&
    settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
    checkboxnum++;
  }
  if (!bomrowid || checkboxnum >= settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var childNum = checkboxnum + 1 + settings.columnOrder.indexOf("checkboxes");
  var checkbox = bomrow.childNodes[childNum].childNodes[0];
  checkbox.checked = true;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function setBomCheckboxes(value) {
  writeStorage("bomCheckboxes", value);
  settings.checkboxes = value.split(",").map((e) => e.trim()).filter((e) => e);
  prepCheckboxes();
  populateMarkWhenCheckedOptions();
  setMarkWhenChecked(settings.markWhenChecked);
}

function setMarkWhenChecked(value) {
  writeStorage("markWhenChecked", value);
  settings.markWhenChecked = value;
  markedFootprints.clear();
  for (var ref of (value ? getStoredCheckboxRefs(value) : [])) {
    markedFootprints.add(ref);
  }
  populateBomTable();
  drawHighlights();
}

function prepCheckboxes() {
  var table = document.getElementById("checkbox-stats");
  while (table.childElementCount > 1) {
    table.removeChild(table.lastChild);
  }
  if (settings.checkboxes.length) {
    table.style.display = "";
  } else {
    table.style.display = "none";
  }
  for (var checkbox of settings.checkboxes) {
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    td.innerHTML = checkbox;
    tr.appendChild(td);
    td = document.createElement("TD");
    td.id = "checkbox-stats-" + checkbox;
    var progressbar = document.createElement("div");
    progressbar.classList.add("bar");
    td.appendChild(progressbar);
    var text = document.createElement("div");
    text.classList.add("text");
    td.appendChild(text);
    tr.appendChild(td);
    table.appendChild(tr);
    updateCheckboxStats(checkbox);
  }
}

function populateMarkWhenCheckedOptions() {
  var container = document.getElementById("markWhenCheckedContainer");

  if (settings.checkboxes.length == 0) {
    container.parentElement.style.display = "none";
    return;
  }

  container.innerHTML = '';
  container.parentElement.style.display = "inline-block";

  function createOption(name, displayName) {
    var id = "markWhenChecked-" + name;

    var div = document.createElement("div");
    div.classList.add("radio-container");

    var input = document.createElement("input");
    input.type = "radio";
    input.name = "markWhenChecked";
    input.value = name;
    input.id = id;
    input.onchange = () => setMarkWhenChecked(name);
    div.appendChild(input);

    // Preserve the selected element when the checkboxes change
    if (name == settings.markWhenChecked) {
      input.checked = true;
    }

    var label = document.createElement("label");
    label.innerHTML = displayName;
    label.htmlFor = id;
    div.appendChild(label);

    container.appendChild(div);
  }
  createOption("", "None");
  for (var checkbox of settings.checkboxes) {
    createOption(checkbox, checkbox);
  }
}

function updateCheckboxStats(checkbox) {
  var checked = getStoredCheckboxRefs(checkbox).size;
  var total = pcbdata.footprints.length - pcbdata.bom.skipped.length;
  var percent = checked * 100.0 / total;
  var td = document.getElementById("checkbox-stats-" + checkbox);
  td.firstChild.style.width = percent + "%";
  td.lastChild.innerHTML = checked + "/" + total + " (" + Math.round(percent) + "%)";
}

function constrain(number, min, max) {
  return Math.min(Math.max(parseInt(number), min), max);
}

document.onkeydown = function (e) {
  switch (e.key) {
    case "n":
      if (document.activeElement.type == "text") {
        return;
      }
      if (currentHighlightedRowId !== null) {
        checkBomCheckbox(currentHighlightedRowId, "placed");
        highlightNextRow();
        e.preventDefault();
      }
      break;
    case "ArrowUp":
      highlightPreviousRow();
      e.preventDefault();
      break;
    case "ArrowDown":
      highlightNextRow();
      e.preventDefault();
      break;
    case "ArrowLeft":
    case "ArrowRight":
      if (document.activeElement.type != "text") {
        e.preventDefault();
        let boardRotationElement = document.getElementById("boardRotation")
        settings.boardRotation = parseInt(boardRotationElement.value);  // degrees / 5
        if (e.key == "ArrowLeft") {
          settings.boardRotation += 3;  // 15 degrees
        }
        else {
          settings.boardRotation -= 3;
        }
        settings.boardRotation = constrain(settings.boardRotation, boardRotationElement.min, boardRotationElement.max);
        boardRotationElement.value = settings.boardRotation
        setBoardRotation(settings.boardRotation);
      }
      break;
    default:
      break;
  }
  if (e.altKey) {
    switch (e.key) {
      case "f":
        focusFilterField();
        e.preventDefault();
        break;
      case "r":
        focusRefLookupField();
        e.preventDefault();
        break;
      case "z":
        changeBomLayout("bom-only");
        e.preventDefault();
        break;
      case "x":
        changeBomLayout("left-right");
        e.preventDefault();
        break;
      case "c":
        changeBomLayout("top-bottom");
        e.preventDefault();
        break;
      case "v":
        changeCanvasLayout("F");
        e.preventDefault();
        break;
      case "b":
        changeCanvasLayout("FB");
        e.preventDefault();
        break;
      case "n":
        changeCanvasLayout("B");
        e.preventDefault();
        break;
      default:
        break;
    }
    if (e.key >= '1' && e.key <= '9') {
      toggleBomCheckbox(currentHighlightedRowId, parseInt(e.key));
      e.preventDefault();
    }
  }
}

function hideNetlistButton() {
  document.getElementById("bom-ungrouped-btn").classList.remove("middle-button");
  document.getElementById("bom-ungrouped-btn").classList.add("right-most-button");
  document.getElementById("bom-netlist-btn").style.display = "none";
}

function topToggle() {
  var top = document.getElementById("top");
  var toptoggle = document.getElementById("toptoggle");
  if (top.style.display === "none") {
    top.style.display = "flex";
    toptoggle.classList.remove("flipped");
  } else {
    top.style.display = "none";
    toptoggle.classList.add("flipped");
  }
}

window.onload = function (e) {
  initRender();
  initStorage();
  initDefaults();
  initUtils();
  cleanGutters();
  populateMetadata();
  dbgdiv = document.getElementById("dbg");
  bom = document.getElementById("bombody");
  bomhead = document.getElementById("bomhead");
  filter = "";
  reflookup = "";
  if (!("nets" in pcbdata)) {
    hideNetlistButton();
  }
  initDone = true;
  setBomCheckboxes(document.getElementById("bomCheckboxes").value);
  // Triggers render
  changeBomLayout(settings.bomlayout);

  // Users may leave fullscreen without touching the checkbox. Uncheck.
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement)
      document.getElementById('fullscreenCheckbox').checked = false;
  });
}

window.onresize = resizeAll;
window.matchMedia("print").addListener(resizeAll);

///////////////////////////////////////////////

///////////////////////////////////////////////

// --- PRODUCTION LOGIC START ---
let isProductionMode = false;
let currentWorkRowId = null; 
window.reworkData = {};
window.operatorInfo = { firstname: "", lastname: "", id: "", startTime: "" };
window.ledServerIP = localStorage.getItem('pi_ip') || "";

// LOGO BASE64 INJECTED
const LOGO_DATA = "data:image/png;base64,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";

function clearAllCheckboxes() {
    const placedName = getPlacedCheckboxName();
    if (window.settings && window.settings.checkboxStoredRefs) {
        window.settings.checkboxStoredRefs[placedName] = ""; 
        if (window.initDone) {
            window.populateBomTable(); 
            window.drawHighlights();
        }
    }
}

function setupInterface() {
    const revEl = document.getElementById('revision');
    if (revEl && !document.getElementById('custom-header-buttons')) {
        const header = revEl.parentElement;
        const currentText = revEl.innerHTML;
        let newHtml = currentText;
        const dateRegex = /(\d{4}-\d{2}-\d{2}.*)/; 
        const match = newHtml.match(dateRegex);
        if (match) {
            const dateHtml = `<div style="font-size: 0.75em; font-weight: normal; margin-top: 2px; color: #ccc;">${match[0]}</div>`;
            newHtml = newHtml.replace(match[0], dateHtml);
        }
        const textSpan = document.createElement('span');
        textSpan.innerHTML = newHtml;
        textSpan.className = 'rev-text-span';
        revEl.innerHTML = ''; 
        revEl.appendChild(textSpan);
        
        const btnMode = document.getElementById('btn-mode-toggle');
        const btnReport = document.getElementById('btn-report');
        const btnLed = document.getElementById('btn-config-led');
        btnMode.id = 'btn-mode-in-header';
        
        const btnContainer = document.createElement('div');
        btnContainer.id = 'custom-header-buttons';
        btnContainer.appendChild(btnLed);
        btnContainer.appendChild(btnMode);
        btnContainer.appendChild(btnReport);
        
        btnMode.style.display = 'inline-flex';
        btnReport.style.display = 'inline-flex';
        btnLed.style.display = 'flex';
        
        if (window.ledServerIP) btnLed.classList.add('connected');
        if (getComputedStyle(header).position === 'static') {
            header.style.position = 'relative';
        }
        header.appendChild(btnContainer);
    }
    const bomDiv = document.getElementById('bomdiv');
    if (bomDiv) {
        if (getComputedStyle(bomDiv).position === 'static') {
            bomDiv.style.position = 'relative';
        }
        ['login-overlay', 'details-overlay', 'completion-overlay', 'rework-overlay'].forEach(id => {
            const el = document.getElementById(id);
            if (el) bomDiv.appendChild(el);
        });
    }
}

async function updateLedStatus(target, context = 'selection') {
    if (!window.ledServerIP) return;
    const apiUrl = `http://${window.ledServerIP}:5000/api/set_led`;
    let payload = {};
    if (target === "all_off") {
        payload = { mode: "off" };
    } else {
        const ledIndex = parseInt(target, 10);
        if (!isNaN(ledIndex)) {
            let color = [0, 0, 255]; 
            let speed = 4.0; 
            let pulse = true;        
            if (context === 'production') {
                color = [255, 0, 0];
                speed = 2.0;         
            } else if (context === 'rework') {
                color = [0, 255, 0];
                speed = 1.0;         
            }
            payload = { mode: "on", index: ledIndex, length: 1, color: color, pulse: pulse, speed: speed };
        } else { return; }
    }
    try {
        await fetch(apiUrl, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) });
    } catch(e) { console.warn("Erreur LED:", e); }
}

function configLedServer() {
    const current = window.ledServerIP || "";
    const ip = prompt("IP du contrleur LED (ex: 192.168.1.156):", current);
    if (ip !== null) {
        window.ledServerIP = ip.trim();
        localStorage.setItem('pi_ip', window.ledServerIP);
        const btn = document.getElementById('btn-config-led');
        if (btn) {
            if (window.ledServerIP) btn.classList.add('connected');
            else btn.classList.remove('connected');
        }
    }
}

function closeOverlay(id) {
    document.getElementById(id).classList.remove('active');
    if (id === 'details-overlay' || id === 'rework-overlay') updateLedStatus('all_off');
}

function toggleHeaderAlert(active) {
    const btn = document.getElementById('btn-mode-in-header') || document.getElementById('btn-mode-toggle');
    if(!btn) return;
    btn.classList.remove('rework-alert');
    if(active) {
        btn.classList.add('rework-alert');
        btn.innerHTML = ' Quitter Reprise';
    } else {
        btn.classList.remove('rework-alert');
        if (isProductionMode) {
            btn.classList.add('mode-active');
            btn.innerHTML = ' Quitter Production';
        } else {
            btn.classList.remove('mode-active');
            btn.innerHTML = ' Dmarrer Production';
        }
    }
}

function closeRework() {
    closeOverlay('rework-overlay');
    toggleHeaderAlert(false); 
}

function openOverlay(id) {
    ['login-overlay', 'details-overlay', 'completion-overlay', 'rework-overlay'].forEach(oid => {
        if(oid !== id) document.getElementById(oid).classList.remove('active');
    });
    document.getElementById(id).classList.add('active');
}

function getPlacedCheckboxName() {
    if (window.settings && window.settings.checkboxes) {
        const found = window.settings.checkboxes.find(c => c.toLowerCase().includes('place'));
        if(found) return found;
        else if (window.settings.checkboxes.length > 0) return window.settings.checkboxes[window.settings.checkboxes.length - 1];
    }
    return "Placed"; 
}

function getComponentData(index) {
    if (!window.pcbdata || !window.pcbdata.footprints[index]) return null;
    const comp = window.pcbdata.footprints[index];
    let val = "N/A", fp = "N/A", box = null;
    if(window.pcbdata.bom.fields && window.pcbdata.bom.fields[index]) {
        const fields = window.pcbdata.bom.fields[index];
        if(window.config && window.config.fields) {
            const valIdx = window.config.fields.indexOf("Value");
            const fpIdx = window.config.fields.indexOf("Footprint");
            const boxIdx = window.config.fields.indexOf("Box");
            if(valIdx >= 0) val = fields[valIdx];
            if(fpIdx >= 0) fp = fields[fpIdx];
            if(boxIdx >= 0) box = fields[boxIdx];
        }
    }
    return { ref: comp.ref, val: val, fp: fp, box: box, index: index };
}

function openMontagePopup(index) {
    const data = getComponentData(index);
    document.getElementById('det-ref').textContent = data.ref;
    document.getElementById('det-val').textContent = data.val;
    document.getElementById('det-fp').textContent = data.fp;
    const boxRow = document.getElementById('det-box-row');
    if (data.box) {
        document.getElementById('det-box').textContent = data.box;
        boxRow.style.display = 'flex';
        updateLedStatus(data.box, 'production');
    } else {
        boxRow.style.display = 'none';
    }
    openOverlay('details-overlay');
}

function checkAndOpenRework(index) {
    const data = getComponentData(index);
    if (!data) return;
    let isChecked = false;
    const placedName = getPlacedCheckboxName();
    if (window.settings && window.settings.checkboxStoredRefs && window.settings.checkboxStoredRefs[placedName]) {
        const storedArray = window.settings.checkboxStoredRefs[placedName].split(',');
        if (storedArray.includes(String(index))) isChecked = true;
    }
    if (!isChecked && window.currentHighlightedRowId) {
        const rowEl = document.getElementById(window.currentHighlightedRowId);
        if (rowEl) {
            const checkboxes = rowEl.querySelectorAll('input[type="checkbox"]');
            if (checkboxes.length > 0 && checkboxes[checkboxes.length - 1].checked) isChecked = true;
        }
    }
    if (isChecked) {
        document.getElementById('rew-ref').textContent = data.ref;
        document.getElementById('rework-reason').value = window.reworkData[data.ref] || "";
        if(data.box) updateLedStatus(data.box, 'rework');
        openOverlay('rework-overlay');
        toggleHeaderAlert(true); 
    } else {
        if(data.box) updateLedStatus(data.box, 'selection');
        if (isProductionMode) {
            closeOverlay('details-overlay');
            closeOverlay('rework-overlay');
            toggleHeaderAlert(false);
        }
    }
}

function findNextUnplacedIndex() {
    const bomBody = document.getElementById('bombody');
    if (!bomBody) return -1;
    const rows = Array.from(bomBody.getElementsByTagName('tr'));
    const placedName = getPlacedCheckboxName();
    let storedArray = [];
    if (window.settings && window.settings.checkboxStoredRefs && window.settings.checkboxStoredRefs[placedName]) {
        storedArray = window.settings.checkboxStoredRefs[placedName].split(',');
    }
    for (let i = 0; i < rows.length; i++) {
        const rowId = rows[i].id; 
        const match = rowId.match(/bomrow(\d+)/);
        if (match) {
            const bomIndex = parseInt(match[1]) - 1; 
            if (window.bomtable && window.bomtable[bomIndex]) {
                const entry = window.bomtable[bomIndex];
                for (let part of entry) {
                    const componentId = part[1];
                    if (!storedArray.includes(String(componentId))) { return componentId; }
                }
            }
        }
    }
    return -1; 
}

function generatePDFReport() {
    const placedName = getPlacedCheckboxName();
    const title = window.pcbdata?.metadata?.title || "Projet";
    const rev = window.pcbdata?.metadata?.revision || "";
    const projectDate = window.pcbdata?.metadata?.date || "N/A";
    const startProdDate = window.operatorInfo.startTime || "N/A";
    const reportDate = new Date().toLocaleString();
    let boxIndex = window.config?.fields?.indexOf("Box") ?? -1;
    
    // UTILISATION DU LOGO BASE64 INJECT
    const logoImgTag = LOGO_DATA ? `<img src="${LOGO_DATA}" alt="Logo" style="max-height: 80px; max-width: 350px;">` : '<h1>RAPPORT</h1>';

    let reportHTML = `
    <html>
    <head>
        <title>Rapport de Production</title>
        <style>
            @page { size: auto; margin: 0; } 
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; margin: 0; }
            .header-container { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #2c3e50; padding-bottom: 15px; margin-bottom: 20px; }
            .logo-area { width: 350px; display:flex; align-items:center; }
            .info-area { text-align: right; }
            .info-title { font-size: 24px; font-weight: bold; margin: 0; color: #2c3e50; }
            .info-date { color: #7f8c8d; margin-top: 3px; font-size: 13px; }
            table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
            th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
            th { background-color: #f8f9fa; color: #2c3e50; font-weight: bold; }
            .status-done { color: #27ae60; font-weight: bold; }
            .status-todo { color: #c0392b; }
            .has-comment { background-color: #fef9e7; }
            .footer-info { margin-top: 40px; padding: 15px; background: #f1f2f6; border-radius: 8px; border-left: 5px solid #2980b9; page-break-inside: avoid; }
            .footer-title { font-weight: bold; color: #2980b9; margin-bottom: 5px; font-size: 14px; }
            .footer-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
            .footer-item { font-size: 14px; color: #333; }
            .supervisor-section { margin-top: 100px; font-size: 16px; font-weight: bold; color: #2c3e50; page-break-inside: avoid; }
        </style>
    </head>
    <body>
        <div class="header-container">
            <div class="logo-area">${logoImgTag}</div>
            <div class="info-area">
                <div class="info-title">Rapport : ${title} <span style="font-size:0.7em">(Rev: ${rev})</span></div>
                <div class="info-date"><b>BOM Gnr :</b> ${projectDate}</div>
                <div class="info-date"><b>Dbut Production :</b> ${startProdDate}</div>
                <div class="info-date"><b>Rapport Gnr :</b> ${reportDate}</div>
            </div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Rfrence</th><th>Valeur</th><th>Empreinte</th>
                    ${boxIndex !== -1 ? '<th>Box</th>' : ''}
                    <th>Statut</th><th>Notes / Raison Reprise</th>
                </tr>
            </thead>
            <tbody>`;

    let flatList = [];
    if(window.bomtable) { window.bomtable.forEach(entry => { entry.forEach(item => flatList.push(item[1])); }); } 
    else { flatList = window.pcbdata.footprints.map((_, i) => i); }
    
    let storedArray = (window.settings?.checkboxStoredRefs?.[placedName] || "").split(',');

    flatList.forEach((idx) => {
        const isChecked = storedArray.includes(String(idx));
        const data = getComponentData(idx);
        const comment = window.reworkData[data.ref] || "";
        const statusText = isChecked ? "MONT" : "NON MONT";
        const statusClass = isChecked ? "status-done" : "status-todo";
        let boxValue = (boxIndex !== -1 && window.pcbdata.bom.fields && window.pcbdata.bom.fields[idx]) ? window.pcbdata.bom.fields[idx][boxIndex] || "" : "";
        const boxCell = boxIndex !== -1 ? `<td>${boxValue}</td>` : '';
        reportHTML += `
            <tr class="${comment ? 'has-comment' : ''}">
                <td>${data.ref}</td><td>${data.val}</td><td>${data.fp}</td>
                ${boxCell}
                <td class="${statusClass}">${statusText}</td>
                <td>${comment}</td>
            </tr>`;
    });

    const op = window.operatorInfo;
    reportHTML += `</tbody></table>
        <div class="footer-info">
            <div class="footer-title">Informations Oprateur / tudiant</div>
            <div class="footer-grid">
                <div class="footer-item"><b>Nom :</b> ${op.lastname || "--"}</div>
                <div class="footer-item"><b>Prnom :</b> ${op.firstname || "--"}</div>
                <div class="footer-item"><b>Matricule :</b> ${op.id || "--"}</div>
            </div>
        </div>
        <div class="supervisor-section">Signature Superviseur : __________________________________________________</div>
        <script>
            window.onload = function() { setTimeout(function() { window.print(); }, 500); };
        <\/script></body></html>`;
        
    const win = window.open('', '_blank');
    if(win) { win.document.write(reportHTML); win.document.close(); } 
    else { alert("Popups bloqus. Autorisez-les pour voir le rapport."); }
}

function toggleProductionMode() {
    const btn = document.getElementById('btn-mode-in-header') || document.getElementById('btn-mode-toggle');
    if (btn.classList.contains('rework-alert')) { closeRework(); return; }
    if (!isProductionMode && (!window.operatorInfo.firstname)) { openOverlay('login-overlay'); return; }

    isProductionMode = !isProductionMode;
    if (isProductionMode) {
        btn.classList.add('mode-active');
        btn.innerHTML = ' Quitter Production';
        const nextIdx = findNextUnplacedIndex();
        if (nextIdx !== -1) openMontagePopup(nextIdx); 
        else openOverlay('completion-overlay');
    } else {
        btn.classList.remove('mode-active');
        btn.innerHTML = ' Dmarrer Production';
        closeOverlay('details-overlay');
        closeOverlay('rework-overlay');
        closeOverlay('completion-overlay');
        toggleHeaderAlert(false); 
        updateLedStatus('all_off'); 
    }
}

function handleLogin() {
    const f = document.getElementById('op-firstname').value.trim();
    const l = document.getElementById('op-lastname').value.trim();
    const i = document.getElementById('op-id').value.trim();
    if(f && l && i) {
        window.operatorInfo = { firstname: f, lastname: l, id: i, startTime: new Date().toLocaleString() };
        sessionStorage.setItem('operatorInfo', JSON.stringify(window.operatorInfo));
        closeOverlay('login-overlay');
        toggleProductionMode();
    } else alert("Info manquante.");
}

document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => { clearAllCheckboxes(); setupInterface(); }, 500);
    document.getElementById('btn-config-led')?.addEventListener('click', configLedServer);
    document.getElementById('btn-login-confirm')?.addEventListener('click', handleLogin);
    document.getElementById('btn-mode-toggle')?.addEventListener('click', toggleProductionMode);
    document.getElementById('btn-report')?.addEventListener('click', generatePDFReport);
    document.getElementById('btn-next-comp')?.addEventListener('click', (e) => {
        const refText = document.getElementById('det-ref').textContent;
        let idx = -1;
        if(window.pcbdata) window.pcbdata.footprints.some((f, i) => { if(f.ref===refText) { idx=i; return true; } });
        if(idx !== -1) {
            if(window.bomtable) {
                window.bomtable.some((entry, r) => {
                    if(entry.some(item => item[1] === idx)) {
                        window.checkBomCheckbox("bomrow"+(r+1), getPlacedCheckboxName());
                        return true;
                    }
                });
            }
            setTimeout(() => {
                const next = findNextUnplacedIndex();
                if(next !== -1) {
                    window.footprintIndexToHandler?.[next]?.();
                    setTimeout(() => openMontagePopup(next), 50);
                } else { closeOverlay('details-overlay'); openOverlay('completion-overlay'); }
            }, 100);
        }
    });
    document.getElementById('btn-submit-rework')?.addEventListener('click', () => {
        const r = document.getElementById('rework-reason').value;
        const ref = document.getElementById('rew-ref').textContent;
        if(r) window.reworkData[ref] = r;
        document.getElementById('rework-reason').value = "";
        closeRework();
    });

    document.body.addEventListener('click', (e) => {
        if (e.target.closest('.custom-card') || e.target.closest('#production-controls') || e.target.classList.contains('ui-btn')) return;
        const isCheckbox = (e.target.tagName === 'INPUT' && e.target.type === 'checkbox');
        const insideBom = e.target.closest('#bomtable');
        const insideCanvas = e.target.closest('#frontcanvas') || e.target.closest('#backcanvas');
        if (insideBom || insideCanvas) {
            setTimeout(() => {
                let idx = null;
                if (window.highlightedFootprints?.length > 0) idx = window.highlightedFootprints[0];
                else if (isCheckbox && insideBom) {
                    const row = e.target.closest('tr');
                    const match = row?.id.match(/bomrow(\d+)/);
                    if(match && window.bomtable?.[parseInt(match[1])-1]?.[0]) idx = window.bomtable[parseInt(match[1])-1][0][1];
                }
                if (idx !== null) checkAndOpenRework(idx);
            }, 100);
        }
    }, true);
    
    const protectedInputs = document.querySelectorAll('input.login-input, textarea.rework-input');
    protectedInputs.forEach(input => {
        ['keydown', 'keypress', 'keyup'].forEach(eventType => {
            input.addEventListener(eventType, (e) => { e.stopPropagation(); });
        });
    });
    console.log("UI Prod NATIVE Loaded.");
});
// --- PRODUCTION LOGIC END ---


///////////////////////////////////////////////
  </script>
</head>

<body>

<div id="topmostdiv" class="topmostdiv">
  <div id="top">
    <div id="fileinfodiv">
      <table class="fileinfo">
        <tbody>
          <tr>
            <td id="title" class="title" style="width: 70%">
              Title
            </td>
            <td id="revision" class="title" style="width: 30%">
              Revision
            </td>
          </tr>
          <tr>
            <td id="company">
              Company
            </td>
            <td id="filedate">
              Date
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="bomcontrols">
      <div class="hideonprint menu">
        <button class="menubtn"></button>
        <div class="menu-content">
          <label class="menu-label menu-label-top" style="width: calc(50% - 18px)">
            <input id="darkmodeCheckbox" type="checkbox" onchange="setDarkMode(this.checked)">
            Dark mode
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label menu-label-top" style="width: calc(50% - 17px); border-left: 0;">
            <input id="fullscreenCheckbox" type="checkbox" onchange="setFullscreen(this.checked)">
            Full Screen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="fabricationCheckbox" type="checkbox" checked onchange="fabricationVisible(this.checked)">
            Fab layer
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="silkscreenCheckbox" type="checkbox" checked onchange="silkscreenVisible(this.checked)">
            Silkscreen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="referencesCheckbox" type="checkbox" checked onchange="referencesVisible(this.checked)">
            References
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="valuesCheckbox" type="checkbox" checked onchange="valuesVisible(this.checked)">
            Values
          </label>
          <div id="tracksAndZonesCheckboxes">
            <label class="menu-label" style="width: calc(50% - 18px)">
              <input id="tracksCheckbox" type="checkbox" checked onchange="tracksVisible(this.checked)">
              Tracks
            </label><!-- This comment eats space! All of it!
            --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
              <input id="zonesCheckbox" type="checkbox" checked onchange="zonesVisible(this.checked)">
              Zones
            </label>
          </div>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="padsCheckbox" type="checkbox" checked onchange="padsVisible(this.checked)">
            Pads
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="dnpOutlineCheckbox" type="checkbox" checked onchange="dnpOutline(this.checked)">
            DNP outlined
          </label>
          <label class="menu-label">
            <input id="highlightRowOnClickCheckbox" type="checkbox" checked onchange="setHighlightRowOnClick(this.checked)">
            Highlight row on click
          </label>
          <label class="menu-label">
            <input id="dragCheckbox" type="checkbox" checked onchange="setRedrawOnDrag(this.checked)">
            Continuous redraw on drag
          </label>
          <label class="menu-label">
            Highlight first pin
            <form id="highlightpin1">
              <div class="flexbox">
                <label>
                  <input type="radio" name="highlightpin1" value="none" onchange="setHighlightPin1('none')">
                  None
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="all" onchange="setHighlightPin1('all')">
                  All
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="selected" onchange="setHighlightPin1('selected')">
                  Selected
                </label>
              </div>
            </form>
          </label>
          <label class="menu-label">
            <span>Board rotation</span>
            <span style="float: right"><span id="rotationDegree">0</span>&#176;</span>
            <input id="boardRotation" type="range" min="-36" max="36" value="0" class="slider" oninput="setBoardRotation(this.value)">
          </label>
          <label class="menu-label">
            <input id="offsetBackRotationCheckbox" type="checkbox" onchange="setOffsetBackRotation(this.checked)">
            Offset back rotation
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Bom checkboxes</div>
            <input id="bomCheckboxes" class="menu-textbox" type=text
                   oninput="setBomCheckboxes(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Mark when checked</div>
            <div id="markWhenCheckedContainer"></div>
          </label>
          <label class="menu-label">
            <span class="shameless-plug">
              <span>Created using</span>
              <a id="github-link" target="blank" href="https://github.com/openscopeproject/InteractiveHtmlBom">InteractiveHtmlBom</a>
              <a target="blank" title="Mouse and keyboard help" href="https://github.com/openscopeproject/InteractiveHtmlBom/wiki/Usage#bom-page-mouse-actions" style="text-decoration: none;"><label class="help-link">?</label></a>
            </span>
          </label>
        </div>
      </div>
      <div class="button-container hideonprint">
        <button id="fl-btn" class="left-most-button" onclick="changeCanvasLayout('F')"
                title="Front only">F
        </button>
        <button id="fb-btn" class="middle-button" onclick="changeCanvasLayout('FB')"
                title="Front and Back">FB
        </button>
        <button id="bl-btn" class="right-most-button" onclick="changeCanvasLayout('B')"
                title="Back only">B
        </button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-btn" class="left-most-button" onclick="changeBomLayout('bom-only')"
                title="BOM only"></button>
        <button id="lr-btn" class="middle-button" onclick="changeBomLayout('left-right')"
                title="BOM left, drawings right"></button>
        <button id="tb-btn" class="right-most-button" onclick="changeBomLayout('top-bottom')"
                title="BOM top, drawings bot"></button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-grouped-btn" class="left-most-button" onclick="changeBomMode('grouped')"
                title="Grouped BOM"></button>
        <button id="bom-ungrouped-btn" class="middle-button" onclick="changeBomMode('ungrouped')"
                title="Ungrouped BOM"></button>
        <button id="bom-netlist-btn" class="right-most-button" onclick="changeBomMode('netlist')"
                title="Netlist"></button>
      </div>
      <div class="hideonprint menu">
        <button class="statsbtn"></button>
        <div class="menu-content">
          <table class="stats">
            <tbody>
              <tr>
                <td width="40%">Board stats</td>
                <td>Front</td>
                <td>Back</td>
                <td>Total</td>
              </tr>
              <tr>
                <td>Components</td>
                <td id="stats-components-front">~</td>
                <td id="stats-components-back">~</td>
                <td id="stats-components-total">~</td>
              </tr>
              <tr>
                <td>Groups</td>
                <td id="stats-groups-front">~</td>
                <td id="stats-groups-back">~</td>
                <td id="stats-groups-total">~</td>
              </tr>
              <tr>
                <td>SMD pads</td>
                <td id="stats-smd-pads-front">~</td>
                <td id="stats-smd-pads-back">~</td>
                <td id="stats-smd-pads-total">~</td>
              </tr>
              <tr>
                <td>TH pads</td>
                <td colspan=3 id="stats-th-pads">~</td>
              </tr>
            </tbody>
          </table>
          <table class="stats">
            <col width="40%"/><col />
            <tbody id="checkbox-stats">
              <tr>
                <td colspan=2 style="border-top: 0">Checkboxes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="hideonprint menu">
        <button class="iobtn"></button>
        <div class="menu-content">
          <div class="menu-label menu-label-top">
            <div style="margin-left: 5px;">Save board image</div>
            <div class="flexbox">
              <input id="render-save-width" class="menu-textbox" type="text" value="1000" placeholder="Width"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
              <span>X</span>
              <input id="render-save-height" class="menu-textbox" type="text" value="1000" placeholder="Height"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
            </div>
            <label>
              <input id="render-save-transparent" type="checkbox">
              Transparent background
            </label>
            <div class="flexbox">
              <button class="savebtn" onclick="saveImage('F')">Front</button>
              <button class="savebtn" onclick="saveImage('B')">Back</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Config and checkbox state</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveSettings()">Export</button>
              <button class="savebtn" onclick="loadSettings()">Import</button>
              <button class="savebtn" onclick="resetSettings()">Reset</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Save bom table as</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveBomTable('csv')">csv</button>
              <button class="savebtn" onclick="saveBomTable('txt')">txt</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="topdivider">
    <div class="hideonprint">
      <div id="toptoggle" onclick="topToggle()"></div>
    </div>
  </div>
  <div id="bot" class="split" style="flex: 1 1">
    <div id="bomdiv" class="split split-horizontal">
      <div style="width: 100%">
        <input id="reflookup" class="textbox searchbox reflookup hideonprint" type="text" placeholder="Ref lookup"
               oninput="updateRefLookup(this.value)">
        <input id="filter" class="textbox searchbox filter hideonprint" type="text" placeholder="Filter"
               oninput="updateFilter(this.value)">
        <div class="button-container hideonprint" style="float: left; margin: 0;">
          <button id="copy" title="Copy bom table to clipboard"
               onclick="saveBomTable('clipboard')"></button>
        </div>
      </div>
      <div id="dbg"></div>
      <table class="bom" id="bomtable">
        <thead id="bomhead">
        </thead>
        <tbody id="bombody">
        </tbody>
      </table>
    </div>
    <div id="canvasdiv" class="split split-horizontal">
      <div id="frontcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="F_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="F_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="F_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="F_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
      <div id="backcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="B_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="B_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="B_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="B_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODULE PRODUCTION (Inject via Template) -->
<div id="production-controls">
    <button id="btn-mode-toggle" class="ui-btn"> Dmarrer Production</button>
    <button id="btn-report" class="ui-btn"> Crer Rapport PDF</button>
    <button id="btn-config-led" class="icon-btn" title="Configurer IP LEDs"></button>
</div>

<div id="login-overlay" class="custom-overlay">
    <div class="custom-card" style="border-color: #3498db;">
        <h2 style="color: #3498db; border-color: #34495e;">Identification Oprateur</h2>
        <p style="color: #ecf0f1; margin-bottom: 20px;">Veuillez saisir vos informations pour le rapport de production.</p>
        <label class="login-label">Prnom</label><input type="text" id="op-firstname" class="login-input" placeholder="Ex: Jean">
        <label class="login-label">Nom</label><input type="text" id="op-lastname" class="login-input" placeholder="Ex: Tremblay">
        <label class="login-label">Matricule</label><input type="text" id="op-id" class="login-input" placeholder="Ex: 1234567">
        <button id="btn-login-confirm" class="action-btn btn-blue">Commencer la Production</button>
    </div>
</div>

<div id="details-overlay" class="custom-overlay">
    <div class="custom-card">
        <h2>Montage en cours</h2>
        <div class="info-row"><span class="info-label">Rfrence:</span><span class="info-value" id="det-ref">--</span></div>
        <div class="info-row"><span class="info-label">Valeur:</span><span class="info-value" id="det-val">--</span></div>
        <div class="info-row"><span class="info-label">Empreinte:</span><span class="info-value" id="det-fp">--</span></div>
        <div class="info-row" id="det-box-row" style="display:none;"><span class="info-label">Casier (Box):</span><span class="info-value" id="det-box">--</span></div>
        <button id="btn-next-comp" class="action-btn btn-next"> Valider & Suivant</button>
    </div>
</div>

<div id="completion-overlay" class="custom-overlay">
    <div class="custom-card" style="text-align: center; border-color: #2ecc71;">
        <h2 style="color: #2ecc71; border-bottom: none;"> Projet Termin !</h2>
        <p style="font-size: 1.2em; margin: 20px 0;">Tous les composants ont t monts.<br>Bon travail !</p>
        <div style="margin-top: 30px;"><p style="font-size: 0.9em; color: #aaa;">(Utilisez le bouton "Quitter Production" pour sortir)</p></div>
    </div>
</div>

<div id="rework-overlay" class="custom-overlay">
    <div class="custom-card" style="border-color: #e74c3c;">
        <button class="close-btn" onclick="closeRework()">&times;</button>
        <h2 style="color: #e74c3c;">Raison de la Reprise</h2>
        <p style="margin-bottom: 15px; color: #fff;">L'lment <b id="rew-ref" style="color:#e74c3c; font-size:1.2em;">--</b> est dj coch ("Placed").</p>
        <p style="margin-bottom: 10px; color: #ccc;">Pourquoi devez-vous le reprendre ?</p>
        <textarea id="rework-reason" class="rework-input" placeholder="Ex: Mauvaise soudure, composant manquant, correction..."></textarea>
        <button id="btn-submit-rework" class="action-btn btn-submit">Enregistrer la Raison</button>
    </div>
</div>


</body>

</html>
